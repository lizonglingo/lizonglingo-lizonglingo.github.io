<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='‰∏∫‰ΩìÈ™åKubernetes‰ª•ÂèäCiliumÁªÑÂêàÂú®‰∏ÄËµ∑‰∫ßÁîüÁöÑÊñ∞ÁâπÊÄßÔºåÊàëËÆ°ÂàíÂ∞ÜKubernetesÂçáÁ∫ßÂà∞1.24&#43;ÔºåÂπ∂‰ΩøÁî®ÊúÄÊñ∞ÁöÑÁ®≥ÂÆöÁâàciliu'>
<title>cri-dockerdÔºåÂú®kubernetes1.24ÂêéÁªßÁª≠‰ΩøÁî®Docker‰Ωú‰∏∫ÂÆπÂô®ËøêË°åÊó∂</title>

<link rel='canonical' href='https://lizonglingo.github.io/p/cri-dockerd%E5%9C%A8kubernetes1.24%E5%90%8E%E7%BB%A7%E7%BB%AD%E4%BD%BF%E7%94%A8docker%E4%BD%9C%E4%B8%BA%E5%AE%B9%E5%99%A8%E8%BF%90%E8%A1%8C%E6%97%B6/'>

<link rel="stylesheet" href="/scss/style.min.811a71d93d8df406268b1c66d015cd3f2252f454f25ac10a683e6f7b5ad9d92d.css"><meta property='og:title' content='cri-dockerdÔºåÂú®kubernetes1.24ÂêéÁªßÁª≠‰ΩøÁî®Docker‰Ωú‰∏∫ÂÆπÂô®ËøêË°åÊó∂'>
<meta property='og:description' content='‰∏∫‰ΩìÈ™åKubernetes‰ª•ÂèäCiliumÁªÑÂêàÂú®‰∏ÄËµ∑‰∫ßÁîüÁöÑÊñ∞ÁâπÊÄßÔºåÊàëËÆ°ÂàíÂ∞ÜKubernetesÂçáÁ∫ßÂà∞1.24&#43;ÔºåÂπ∂‰ΩøÁî®ÊúÄÊñ∞ÁöÑÁ®≥ÂÆöÁâàciliu'>
<meta property='og:url' content='https://lizonglingo.github.io/p/cri-dockerd%E5%9C%A8kubernetes1.24%E5%90%8E%E7%BB%A7%E7%BB%AD%E4%BD%BF%E7%94%A8docker%E4%BD%9C%E4%B8%BA%E5%AE%B9%E5%99%A8%E8%BF%90%E8%A1%8C%E6%97%B6/'>
<meta property='og:site_name' content='fmt.Println(&#34;Li Duo&#34;)'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='‰∫ëÂéüÁîü' /><meta property='article:tag' content='Kubernetes' /><meta property='article:tag' content='docker' /><meta property='article:tag' content='Á¨îËÆ∞' /><meta property='article:tag' content='‰∏≠Èó¥‰ª∂' /><meta property='article:published_time' content='2022-08-01T18:10:59&#43;08:00'/><meta property='article:modified_time' content='2022-08-01T18:10:59&#43;08:00'/><meta property='og:image' content='https://picgo-lzl.oss-cn-beijing.aliyuncs.com/image-20230111161434207.png' />
<meta name="twitter:title" content="cri-dockerdÔºåÂú®kubernetes1.24ÂêéÁªßÁª≠‰ΩøÁî®Docker‰Ωú‰∏∫ÂÆπÂô®ËøêË°åÊó∂">
<meta name="twitter:description" content="‰∏∫‰ΩìÈ™åKubernetes‰ª•ÂèäCiliumÁªÑÂêàÂú®‰∏ÄËµ∑‰∫ßÁîüÁöÑÊñ∞ÁâπÊÄßÔºåÊàëËÆ°ÂàíÂ∞ÜKubernetesÂçáÁ∫ßÂà∞1.24&#43;ÔºåÂπ∂‰ΩøÁî®ÊúÄÊñ∞ÁöÑÁ®≥ÂÆöÁâàciliu"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://picgo-lzl.oss-cn-beijing.aliyuncs.com/image-20230111161434207.png' />
    <link rel="shortcut icon" href="/favicon.ico" />

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="ÂàáÊç¢ËèúÂçï">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    <img src="https://picgo-lzl.oss-cn-beijing.aliyuncs.com/1634453613659.jpeg" width="300" height="300" class="site-logo" loading="lazy" alt="Avatar">
                
                </a>
                
                    <span class="emoji">üëã</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">fmt.Println(&#34;Li Duo&#34;)</a></h1>
            <h2 class="site-description"></h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://github.com/lizonglingo'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
            
        
                
                <li >
                    <a href='/' >
                        
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                        
                        <span>‰∏ªÈ°µ</span>
                    </a>
                </li>
                
            
        
        
            
        
                
                <li >
                    <a href='/%E5%85%B3%E4%BA%8E/' >
                        
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                        
                        <span>ÂÖ≥‰∫é</span>
                    </a>
                </li>
                
            
        
        
            
        
                
                <li >
                    <a href='/archives/' >
                        
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                        
                        <span>ÂΩíÊ°£</span>
                    </a>
                </li>
                
            
        
        
            
        
        
        
            
        
                
                <li >
                    <a href='/%E9%93%BE%E6%8E%A5/' >
                        
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                        
                        <span>ÈìæÊé•</span>
                    </a>
                </li>
                
            
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>ÊöóËâ≤Ê®°Âºè</span>
                </li>
            
        </div>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                <form action="/search/" class="search-form widget" >
        <p>
            <label>ÊêúÁ¥¢</label>
            <input name="keyword" required placeholder="ËæìÂÖ•ÂÖ≥ÈîÆËØç..." />
        
            <button title="ÊêúÁ¥¢">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



            </button>
        </p>
    </form>
            
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">ÁõÆÂΩï</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ul>
    <li><a href="#dockershimÂíåÂÆπÂô®ËøêË°åÊó∂">DockershimÂíåÂÆπÂô®ËøêË°åÊó∂</a>
      <ul>
        <li><a href="#ÂºÉÁî®dockershimÂêédockerËøòÊúâÁî®Âêó">ÂºÉÁî®dockershimÂêéÔºåDockerËøòÊúâÁî®ÂêóÔºü</a></li>
      </ul>
    </li>
    <li><a href="#Âú®Êñ∞ÁâàÊú¨ÈõÜÁæ§‰∏≠‰ΩøÁî®cri-dockerd">Âú®Êñ∞ÁâàÊú¨ÈõÜÁæ§‰∏≠‰ΩøÁî®cri-dockerd</a>
      <ul>
        <li><a href="#ÂÆâË£ÖÂπ∂ÈÖçÁΩÆcri-dockerd">ÂÆâË£ÖÂπ∂ÈÖçÁΩÆcri-dockerd</a></li>
        <li><a href="#‰øÆÊîπkubeadm-configÊñá‰ª∂">‰øÆÊîπkubeadm configÊñá‰ª∂</a></li>
        <li><a href="#ÂêØÂä®ÈõÜÁæ§ÂêØÂä®Â§±Ë¥•">ÂêØÂä®ÈõÜÁæ§(ÂêØÂä®Â§±Ë¥•)</a></li>
        <li><a href="#cni">CNI</a></li>
        <li><a href="#ÂÜçÊ¨°ÂêØÂä®ÈõÜÁæ§">ÂÜçÊ¨°ÂêØÂä®ÈõÜÁæ§</a></li>
      </ul>
    </li>
    <li><a href="#‰∏Ä‰∫õÈóÆÈ¢ò">‰∏Ä‰∫õÈóÆÈ¢ò</a>
      <ul>
        <li><a href="#cri-dockerdÊä•Èîô">cri-dockerdÊä•Èîô</a></li>
        <li><a href="#cri-dockerdÂ∏∏È©ª‰∏Ä‰∏™ÁªàÁ´Ø">cri-dockerdÂ∏∏È©ª‰∏Ä‰∏™ÁªàÁ´Ø</a></li>
      </ul>
    </li>
    <li><a href="#ÂèÇËÄÉËµÑÊñô">ÂèÇËÄÉËµÑÊñô</a></li>
  </ul>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/cri-dockerd%E5%9C%A8kubernetes1.24%E5%90%8E%E7%BB%A7%E7%BB%AD%E4%BD%BF%E7%94%A8docker%E4%BD%9C%E4%B8%BA%E5%AE%B9%E5%99%A8%E8%BF%90%E8%A1%8C%E6%97%B6/">
                
                    <img src="https://picgo-lzl.oss-cn-beijing.aliyuncs.com/image-20230111161434207.png" loading="lazy" alt="Featured image of post cri-dockerdÔºåÂú®kubernetes1.24ÂêéÁªßÁª≠‰ΩøÁî®Docker‰Ωú‰∏∫ÂÆπÂô®ËøêË°åÊó∂" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/%E4%BA%91%E5%8E%9F%E7%94%9F/" >
                ‰∫ëÂéüÁîü
            </a>
        
            <a href="/categories/kubernetes/" >
                Kubernetes
            </a>
        
            <a href="/categories/docker/" >
                docker
            </a>
        
            <a href="/categories/%E7%AC%94%E8%AE%B0/" >
                Á¨îËÆ∞
            </a>
        
            <a href="/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/" >
                ‰∏≠Èó¥‰ª∂
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/cri-dockerd%E5%9C%A8kubernetes1.24%E5%90%8E%E7%BB%A7%E7%BB%AD%E4%BD%BF%E7%94%A8docker%E4%BD%9C%E4%B8%BA%E5%AE%B9%E5%99%A8%E8%BF%90%E8%A1%8C%E6%97%B6/">cri-dockerdÔºåÂú®kubernetes1.24ÂêéÁªßÁª≠‰ΩøÁî®Docker‰Ωú‰∏∫ÂÆπÂô®ËøêË°åÊó∂</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Aug 01, 2022</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    ÈòÖËØªÊó∂Èïø: 15 ÂàÜÈíü
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <blockquote>
<p>‰∏∫‰ΩìÈ™åKubernetes‰ª•ÂèäCiliumÁªÑÂêàÂú®‰∏ÄËµ∑‰∫ßÁîüÁöÑÊñ∞ÁâπÊÄßÔºåÊàëËÆ°ÂàíÂ∞ÜKubernetesÂçáÁ∫ßÂà∞1.24+ÔºåÂπ∂‰ΩøÁî®ÊúÄÊñ∞ÁöÑÁ®≥ÂÆöÁâàcilium1.12Êù•‰ΩúÈõÜÁæ§ÁΩëÁªú„ÄÇ</p>
<p>ÊàëÊâÄÁúãÈáçÁöÑÊúÄÂ§ßÊîπÂèòÔºö</p>
<ul>
<li>kubernetes1.24+Ê≠£ÂºèÁßªÈô§dockershimÔºåÂÖ≥‰∫é‚ÄúkubernetesÂºÉÁî®Docker‚ÄùËøô‰∏ÄËØùÈ¢ò‰πüÁÆóÊòØÂ∞òÂüÉËêΩÂÆöÔºåkubernetesÊ≠£ÂºèÊã•Êä±Á∫ØÂáÄÁöÑCRI„ÄÇ</li>
<li>cilium1.12ÂêéÊ≠£ÂºèÊîØÊåÅkubernetes1.24.0ÔºåÂπ∂‰∏îÂÖ∂ÈáçÂ§ßÁöÑÊñ∞ÁâπÊÄßcilium service meshÂºïËµ∑‰∫ÜÊàëÁöÑÂÖ¥Ë∂£Ôºå‚Äúmulti control plan‚Äù„ÄÅ‚Äúsidercar/sidercar-free‚ÄùÁ≠â‰∫ÆÁÇπËÆ©ÊàëÂæàÊÉ≥Â∞ùËØïÔºåÊòØ‰∏çÊòØÂü∫‰∫éeBPFÁöÑservice meshÂú®ÊÄßËÉΩÂºÄÈîÄ„ÄÅÊåáÊ†áÁ≤íÂ∫¶‰∏äËÉΩÂ§üÁªô‰∫ë‰∏äÂèØËßÇÊµãÊÄßÂ∏¶Êù•Êõ¥Â•ΩÁöÑ‰ΩìÈ™å„ÄÇ</li>
</ul>
</blockquote>
<p>ÊâÄ‰ª•ÔºåÁ¨¨‰∏Ä‰∏™ÈóÆÈ¢òÊù•‰∫ÜÔºåÁßªÈô§dockershimÂêéÔºåÊàë‰ª¨ÊÄéÊ†∑ÁªßÁª≠‰ΩøÁî®docker engine‰Ωú‰∏∫Â∫ïÂ±ÇÁöÑÂÆπÂô®ÁÆ°ÁêÜ‰ª•ÂèäËøêË°åÊó∂ÁÆ°ÁêÜËÄÖÂë¢Ôºü</p>
<h2 id="dockershimÂíåÂÆπÂô®ËøêË°åÊó∂">DockershimÂíåÂÆπÂô®ËøêË°åÊó∂</h2>
<p>Êàë‰ª¨Áü•ÈÅìÔºåÊèê‰æõÊúçÂä°ÁöÑÁªàÁÇπÊòØPod‰∏≠ËøêË°åÁöÑÂÆπÂô®ÔºåkubernetesÊú¨Ë∫´Âπ∂‰∏çÊèê‰æõËøôÁßçËÉΩÂäõÔºåËÄåÊòØ‰æùËµñCRIÂéªÊé•ÂÖ•ÂÖ∂‰ªñÂÆπÂô®ËøêË°åÊó∂ÔºåÂÆûÁé∞ËøôÊ†∑ÁöÑËÉΩÂäõÁöÑ„ÄÇÊàë‰ª¨ÊúÄÁõ¥Êé•ÁöÑ‰Ωì‰ºöÂ∞±ÊòØkubernetesÂèØ‰ª•ÊåâÁÖßÂ£∞ÊòéÊñá‰ª∂Ëá™Âä®ÊãâÂèñ„ÄÅËøêË°åÂÆπÂô®ÔºåÂÖ∂ÂÆûËøôÈÉΩÊòØÂÆπÂô®ËøêË°åÊó∂ÁöÑÂ∑•‰Ωú„ÄÇ‰æãÂ¶ÇdockerÔºåÂÆÉÂ∞±ÊúâËøôÊ†∑ÁöÑËÉΩÂäõÔºåÂπ∂‰∏îÂú®k8sÂèëÂ±ïÂàùÊúüÔºåDockerÁîöËá≥ÊØîk8sÊõ¥ÊúâÁü•ÂêçÂ∫¶ÔºåÂêåÊó∂DockerÊØîk8s CRIËøôÊ†∑Ê¶ÇÂøµË¶ÅÊó©Ôºådocker engine‰πüÂ∞±Ê≤°ÊúâÂÆûÁé∞CRIÊé•Âè£Ëøô‰∏ÄËØ¥ÔºåÊâÄ‰ª•k8s‰ΩøÁî®<code>dockershim</code>‰Ωú‰∏∫ÊîØÊíëdockerËøô‰∏ÄÂÆπÂô®ËøêË°åÊó∂ÁöÑËøáÊ∏°„ÄÇÂõ†Ê≠§Âú®k8sÊó©ÊúüÁâàÊú¨ÔºåÂ∞±ÈíàÂØπdockerËøô‰∏™ÂÆπÂô®ËøêË°åÊó∂ÂÅö‰∫ÜÈÄÇÈÖç„ÄÇ</p>
<p>ÊØè‰∏™ËäÇÁÇπ‰∏äÁöÑkubeletÂú®dockershimÁöÑËÉΩÂäõ‰∏ãÔºåÂèØ‰ª•‰∏éËäÇÁÇπ‰∏äÁöÑdocker engineËøõË°å‰∫§‰∫íÔºåÂéª‰ΩøÁî®dockerÁöÑËÉΩÂäõ„ÄÇ<img src="https://picgo-lzl.oss-cn-beijing.aliyuncs.com/image-20220730233109830.png"
	
	
	
	loading="lazy"
	
		alt="image-20220730233109830"
	
	
></p>
<p>‰ªé‰∏äÂõæ‰∏≠ÂèØ‰ª•ÁúãÂá∫ÔºådockershimÁöÑ‰ΩúÁî®‰∏é‰∏Ä‰∏™CRIÂÆûÁé∞ÊòØ‰∏ÄÊ†∑ÁöÑ„ÄÇÂ∞ΩÁÆ°ÁõÆÂâçdockerÂ∫ïÂ±Ç‰πüÊòØ‰ΩøÁî®‰∫Ü<code>containerd</code>Ôºå‰ΩÜÊòØÊàë‰ª¨ËøòÈúÄË¶ÅÂ§ö‰∏Ä‰∏™‰∏≠Èó¥ÁéØËäÇÔºåÁî®dockerË∞ÉÁî®containerd„ÄÇ</p>
<p>ËÄåk8s‰∏≠CRI‰πã‰∏Ä<code>containerd</code>Âàô‰∏∫k8sÊèê‰æõ‰∫ÜÁõ¥Êé•Ë∞ÉÁî®containerdÁöÑËÉΩÂäõ„ÄÇ</p>
<blockquote>
<p>ÁõÆÂâç‰∏ªË¶ÅÁöÑCRIÂÆûÁé∞ÊúâÔºö</p>
<ul>
<li>containerd</li>
<li>cri-o</li>
<li>cri-dockerd</li>
</ul>
</blockquote>
<p>Ê≠£Âõ†Â¶ÇÊ≠§Ôºåk8s‰∏çÂøÖÂ±ÄÈôê‰∫édockerËøô‰∏ÄÁßçËøêË°åÊó∂ÔºåCRIÁöÑËÉΩÂäõÂèØ‰ª•ËÆ©k8s‰ΩøÁî®ÁâπÊÄß‰∏çÂêåÁöÑÂÆπÂô®ËøêË°åÊó∂„ÄÇ</p>
<h3 id="ÂºÉÁî®dockershimÂêédockerËøòÊúâÁî®Âêó">ÂºÉÁî®dockershimÂêéÔºåDockerËøòÊúâÁî®ÂêóÔºü</h3>
<p>ÂΩìÁÑ∂„ÄÇ</p>
<p>Âú®ÊàëÁöÑÂç∞Ë±°ÈáåÔºådocker‰ªçÁÑ∂ÊòØÁõÆÂâç‰ΩøÁî®ÊúÄÂ§öÁöÑÂÆπÂô®ÊâìÂåÖÊûÑÂª∫„ÄÅÈïúÂÉèÁÆ°ÁêÜÂíåËøêË°åÂ∑•ÂÖ∑„ÄÇdocker hubÊúâ‰∏∞ÂØåÈïúÂÉèËµÑÊ∫ê„ÄÅÊúâÂæàÂ§öÂºÄÂèëËÄÖÂú®‰ΩøÁî®dockerÂéªÊûÑÂª∫Ëá™Â∑±Â∫îÁî®ÈïúÂÉè„ÄÇ‰ΩøÁî®<code>docker build</code>ÊâìÂåÖÁöÑÈïúÂÉè‰æùÁÑ∂Á¨¶ÂêàCRIÁöÑÊ†áÂáÜÔºàÂõ†‰∏∫Â∑≤ÁªèÂÆπÂô®ËøêË°åÊó∂‰ª•ÂèäÊúâÊ†áÂáÜÂåñÁªÑÁªáOCI‰∏∫ÂÖ∂Âà∂ÂÆöËßÑËåÉ‰∫ÜÔºâ„ÄÇ</p>
<p>Âè™‰∏çËøáÔºåÂéüÊù•‰∏∫docker engineÂÅöÈÄÇÈÖçÂ∑•‰ΩúÁé∞Âú®Â∑≤Áªè‰∏çÂ±û‰∫ék8sÁ§æÂå∫ÁöÑÁÆ°ËæñËåÉÂõ¥ÔºåÈúÄË¶ÅÂÖ∂‰ªñÁ§æÂå∫Ëá™Â∑±ÂéªÊåâÁÖßCRIÁöÑÊ†áÂáÜÔºå‰∏∫docker engineÁºñÂÜôÊé•ÂÖ•k8sÁöÑ‚ÄúËΩ¨Êé•Â§¥‚Äù„ÄÇÂõ†Ê≠§ÔºåÂ∞±Êúâ‰∫Ü<code>cri-dockerd</code>„ÄÇ</p>
<p>Â¶ÇÊûúÊàë‰ª¨ÊÉ≥ÁªßÁª≠‰ΩøÁî®Âú®k8s‰∏≠‰ΩøÁî®dockerÔºåÂ∞±ÂøÖÈ°ª‰ΩøÁî®<code>cri-dockerd</code>‰Ωú‰∏∫ÈÄÇÈÖçÂô®ÔºåÂÆÉËÆ©Êàë‰ª¨ÂèØ‰ª•ÈÄöËøáCRIÊù•‰ΩøÁî®docker engine„ÄÇ</p>
<h2 id="Âú®Êñ∞ÁâàÊú¨ÈõÜÁæ§‰∏≠‰ΩøÁî®cri-dockerd">Âú®Êñ∞ÁâàÊú¨ÈõÜÁæ§‰∏≠‰ΩøÁî®cri-dockerd</h2>
<p>‰πãÂâçÁöÑÂçöÂÆ¢‰∏≠Êàë‰ª¨ÂàÜ‰∫´Âà∞ÔºåÊê≠Âª∫ÈõÜÁæ§Âè™ÈúÄË¶ÅËäÇÁÇπ‰∏äÊúâdocker engineÂ∞±ÂèØ‰ª•ÔºåÁÑ∂ÂêéÊåâÁÖß<code>kubeadm</code>Ôºå<code>kubelet</code>Ôºå<code>kubectl</code>Â∞±ÂèØ‰ª•‰∫ÜÔºå‰∏ç‰ºöÂéªÂàªÊÑè„ÄÅÊòæÂºèÁöÑÈÖçÁΩÆÂÆπÂô®ËøêË°åÊó∂„ÄÇÈÇ£ÊòØÂõ†‰∏∫k8sÂÜÖÁΩÆÁöÑdockershimËá™Âä®Â∏ÆÊàë‰ª¨ÂÆåÊàê‰∫ÜËøô‰∏™Â∑•‰Ωú„ÄÇ</p>
<p>Âú®1.24.0‰πãÂêéÔºåÊàë‰ª¨Âú®ÂàõÂª∫ÈõÜÁæ§‰πãÂâçÔºå‰πüË¶ÅÂÉèÂÆâË£ÖCNIÈÇ£Ê†∑ÂÖàÈÖçÁΩÆÊàë‰ª¨ÁöÑÂÆπÂô®ËøêË°åÊó∂ÔºåÊâçÂèØ‰ª•Ê≠£Â∏∏ÂàùÂßãÂåñk8sÈõÜÁæ§„ÄÇ</p>
<h3 id="ÂÆâË£ÖÂπ∂ÈÖçÁΩÆcri-dockerd">ÂÆâË£ÖÂπ∂ÈÖçÁΩÆcri-dockerd</h3>
<p>:warning:ËøôÈúÄË¶ÅËäÇÁÇπ‰∏äÊúâÊ≠£Â∏∏ËøêË°åÁöÑdocker engine„ÄÇÂêåÊó∂Ë¶ÅÂú®ÊâÄÊúâËäÇÁÇπ‰∏äÂÆâË£Öcri-dockerd„ÄÇ</p>
<p>Êàë‰ª¨ËøôÈáå‰ΩøÁî®Ubuntu22.04‰Ωú‰∏∫ÁéØÂ¢ÉÔºåÁõ¥Êé•Âú®<a class="link" href="https://github.com/Mirantis/cri-dockerd/releases"  target="_blank" rel="noopener"
    >release</a>‰∏ãËΩΩÊûÑÂª∫Â•ΩÁöÑÂØπÂ∫îUbuntuÁâàÊú¨ÁöÑ<code>.deb</code>ÂÆâË£ÖÊñá‰ª∂„ÄÇ</p>
<p><img src="https://picgo-lzl.oss-cn-beijing.aliyuncs.com/202207311437400.png"
	
	
	
	loading="lazy"
	
		alt="image-20220731143731223"
	
	
></p>
<p>ÁÑ∂ÂêéÔºåËøõË°åÂÆâË£ÖÔºö</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>&gt; dpkg -i cri-dockerd_0.2.3.3-0.ubuntu-jammy_amd64.deb
</span></span><span style="display:flex;"><span>Selecting previously unselected package cri-dockerd.
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>Reading database ... <span style="color:#ae81ff">212454</span> files and directories currently installed.<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Preparing to unpack cri-dockerd_0.2.3.3-0.ubuntu-jammy_amd64.deb ...
</span></span><span style="display:flex;"><span>Unpacking cri-dockerd <span style="color:#f92672">(</span>0.2.3~3-0~ubuntu-jammy<span style="color:#f92672">)</span> ...
</span></span><span style="display:flex;"><span>Setting up cri-dockerd <span style="color:#f92672">(</span>0.2.3~3-0~ubuntu-jammy<span style="color:#f92672">)</span> ...
</span></span><span style="display:flex;"><span>Created symlink /etc/systemd/system/multi-user.target.wants/cri-docker.service ‚Üí /lib/systemd/system/cri-docker.service.
</span></span><span style="display:flex;"><span>Created symlink /etc/systemd/system/sockets.target.wants/cri-docker.socket ‚Üí /lib/systemd/system/cri-docker.socket.
</span></span></code></pre></div><p>ÂÆâË£ÖlogÈáåÊúâ‰∏§‰∏™ÂæàÈáçË¶ÅÁöÑ‰ø°ÊÅØÁÇπÔºö</p>
<p><code>Created symlink /etc/systemd/system/multi-user.target.wants/cri-docker.service ‚Üí /lib/systemd/system/cri-docker.service.</code></p>
<p><code>Created symlink /etc/systemd/system/sockets.target.wants/cri-docker.socket ‚Üí /lib/systemd/system/cri-docker.socket.</code></p>
<blockquote>
<p><code>sysmlink</code>ÊòØLinux‰∏≠ÁöÑ‰∏ÄÁßçÊñá‰ª∂Á±ªÂûãÔºåÁß∞‰∏∫‚ÄúÁ¨¶Âè∑ÈìæÊé•‚Äù„ÄÅ‚ÄúËΩØÈìæÊé•‚ÄùÔºåÊåáÂêëËÆ°ÁÆóÊú∫‰∏äÂè¶‰∏Ä‰∏™Êñá‰ª∂ÊàñËÄÖÊñá‰ª∂Â§π„ÄÇÁ±ª‰ºº‰∫éWindows‰∏≠ÁöÑÂø´Êç∑ÊñπÂºè„ÄÇËøôÁßçÈìæÊé•Êñá‰ª∂ËÆ∞ÂΩï‰∫ÜË¢´ÈìæÊé•Êñá‰ª∂ÁöÑË∑ØÂæÑÔºåÊõ¥Êñπ‰æøÁöÑËÆøÈóÆÊüê‰∫õÊñá‰ª∂„ÄÇ</p>
</blockquote>
<p>Âú®ÂÆâË£Öcri-dockerdÊó∂Ôºå‰∏∫<code>cri-docker.service</code>ÔºåÂíå<code>cri-docker.socket</code>ÂàõÂª∫‰∫ÜËΩØÈìæÊé•„ÄÇ</p>
<p>ÂÆâË£ÖÂêéÔºåÊàë‰ª¨ÊâßË°å<code>cri-dockerd -h</code> ‰∫ÜËß£‰∏Ä‰∏ãÂü∫Êú¨‰ø°ÊÅØÔºö</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>&gt; cri-dockerd -h
</span></span><span style="display:flex;"><span>CRI that connects to the Docker Daemon
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Usage:
</span></span><span style="display:flex;"><span>  cri-dockerd <span style="color:#f92672">[</span>flags<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Flags:
</span></span><span style="display:flex;"><span>      --buildinfo                               Prints the build information about cri-dockerd
</span></span><span style="display:flex;"><span>      --cni-bin-dir string                      &lt;Warning: Alpha feature&gt; A comma-separated list of full paths of directories in which to search <span style="color:#66d9ef">for</span> CNI plugin binaries. <span style="color:#f92672">(</span>default <span style="color:#e6db74">&#34;/opt/cni/bin&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      --cni-cache-dir string                    &lt;Warning: Alpha feature&gt; The full path of the directory in which CNI should store cache files. <span style="color:#f92672">(</span>default <span style="color:#e6db74">&#34;/var/lib/cni/cache&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      --cni-conf-dir string                     &lt;Warning: Alpha feature&gt; The full path of the directory in which to search <span style="color:#66d9ef">for</span> CNI config files <span style="color:#f92672">(</span>default <span style="color:#e6db74">&#34;/etc/cni/net.d&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      --container-runtime-endpoint string       The endpoint of backend runtime service. Currently unix socket and tcp endpoints are supported on Linux, <span style="color:#66d9ef">while</span> npipe and tcp endpoints are supported on windows.  Examples:<span style="color:#e6db74">&#39;unix:///var/run/cri-dockerd.sock&#39;</span>, <span style="color:#e6db74">&#39;npipe:////./pipe/cri-dockerd&#39;</span> <span style="color:#f92672">(</span>default <span style="color:#e6db74">&#34;unix:///var/run/cri-dockerd.sock&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      --cri-dockerd-root-directory string       Path to the cri-dockerd root directory. <span style="color:#f92672">(</span>default <span style="color:#e6db74">&#34;/var/lib/cri-dockerd&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      --docker-endpoint string                  Use this <span style="color:#66d9ef">for</span> the docker endpoint to communicate with. <span style="color:#f92672">(</span>default <span style="color:#e6db74">&#34;unix:///var/run/docker.sock&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      --hairpin-mode HairpinMode                &lt;Warning: Alpha feature&gt; The mode of hairpin to use. <span style="color:#f92672">(</span>default none<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  -h, --help                                    Help <span style="color:#66d9ef">for</span> cri-dockerd
</span></span><span style="display:flex;"><span>      --image-pull-progress-deadline duration   If no pulling progress is made before this deadline, the image pulling will be cancelled. <span style="color:#f92672">(</span>default 1m0s<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      --ipv6-dual-stack                         Enable IPv6 dual stack support
</span></span><span style="display:flex;"><span>      --log-level string                        The log level <span style="color:#66d9ef">for</span> cri-docker <span style="color:#f92672">(</span>default <span style="color:#e6db74">&#34;info&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      --network-plugin string                   &lt;Warning: Alpha feature&gt; The name of the network plugin to be invoked <span style="color:#66d9ef">for</span> various events in kubelet/pod lifecycle.
</span></span><span style="display:flex;"><span>      --network-plugin-mtu int32                &lt;Warning: Alpha feature&gt; The MTU to be passed to the network plugin, to override the default. Set to <span style="color:#ae81ff">0</span> to use the default <span style="color:#ae81ff">1460</span> MTU.
</span></span><span style="display:flex;"><span>      --pod-cidr string                         The CIDR to use <span style="color:#66d9ef">for</span> pod IP addresses, only used in standalone mode.  In cluster mode, this is obtained from the master. For IPv6, the maximum number of IP<span style="color:#960050;background-color:#1e0010">&#39;</span>s allocated is <span style="color:#ae81ff">65536</span>
</span></span><span style="display:flex;"><span>      --pod-infra-container-image string        The image whose network/ipc namespaces containers in each pod will use <span style="color:#f92672">(</span>default <span style="color:#e6db74">&#34;k8s.gcr.io/pause:3.6&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>      --runtime-cgroups string                  Optional absolute name of cgroups to create and run the runtime in.
</span></span><span style="display:flex;"><span>      --version                                 Prints the version of cri-dockerd
</span></span></code></pre></div><p>‰ªé‚ÄúCRI that connects to the Docker Daemon‚Äù‰∏≠ÁúãÂà∞Ôºåcri-dockerdÁöÑ‰ΩúÁî®ÊòØËøûÊé•ËäÇÁÇπ‰∏äÁöÑdocker daemonÁöÑÔºåÁÑ∂Âêék8sÂÜçËøûÊé•cri-dockerdÔºåÂ∞±ËÉΩ‰ΩøÁî®docker‰Ωú‰∏∫ÂÆπÂô®ËøêË°åÊó∂‰∫Ü„ÄÇ</p>
<ul>
<li><code>--cni-bin-dir string</code></li>
<li><code>--cni-cache-dir string</code></li>
<li><code>--cni-conf-dir string</code></li>
</ul>
<p>‰∏äÈù¢‰∏â‰∏™ÂèÇÊï∞ÊòØÂÖ≥‰∫éÂÆπÂô®ÁΩëÁªúÁöÑÔºåÊöÇÊó∂Âú®alphaÈò∂ÊÆµ„ÄÇ</p>
<ul>
<li><code>--container-runtime-endpoint</code></li>
</ul>
<p>Ëøô‰∏™ÂèÇÊï∞ÈúÄË¶ÅÊàë‰ª¨Ê≥®ÊÑèÔºåÂÆÉÊåáÂÆö‰∫Ük8sÈúÄË¶ÅËøûÊé•CRIÁ´ØÁÇπÔºåÈªòËÆ§ÊòØ<code>unix:///var/run/cri-dockerd.sock</code>ÔºåÂú®ÂêéÈù¢ÈÖçÁΩÆkubeadm configÊó∂ÈúÄË¶ÅÁî®Âà∞„ÄÇ</p>
<ul>
<li><code>--docker-endpoint string</code></li>
</ul>
<p>Ëøô‰∏™ÂèÇÊï∞Â∞±ÊòØcri-dockerdË¶ÅÂéªËøûÊé•ÁöÑdocker daemonÁöÑÁ´ØÁÇπÔºåÊù•‰ΩøÁî®dockerÁöÑËÉΩÂäõ„ÄÇ</p>
<ul>
<li><code>--pod-cidr string</code></li>
</ul>
<p>ËØ•ÂèÇÊï∞Âè™ÊúâÂú®ÂçïËäÇÁÇπÈÉ®ÁΩ≤Êó∂Êâç‰ºöÁî®Âà∞ÔºåÂú®ÈõÜÁæ§ÁéØÂ¢É‰∏ãcri-dockerdÈÄöËøáËé∑Âèñmaster nodeÁöÑ‰ø°ÊÅØÁü•ÊôìpodÁöÑcidrÂàíÂàÜ„ÄÇ</p>
<ul>
<li><code>--pod-infra-container-image</code></li>
</ul>
<p>ËØ•ÂèÇÊï∞ÂèØ‰ª•Áî®Êù•ËÆæÁΩÆPod‰∏≠ÁöÑpauseÂÆπÂô®ÁöÑÈïúÂÉèÁâàÊú¨ÔºåÈªòËÆ§‰ΩøÁî®<code>k8s.gcr.io/pause:3.6</code>Ëøô‰∏™ÈïúÂÉè„ÄÇ‰ΩÜÊòØÂú®k8s1.24‰∏≠ÔºåÂ∫îËØ•‰ΩøÁî®3.7ÁâàÊú¨ÔºåÂπ∂‰∏îË¶ÅÊç¢ÊàêaliyunÈïúÂÉèÔºåÂú®ÂêéÈù¢ÈúÄË¶ÅËÆæÁΩÆ„ÄÇ</p>
<h3 id="‰øÆÊîπkubeadm-configÊñá‰ª∂">‰øÆÊîπkubeadm configÊñá‰ª∂</h3>
<p>ÊàëÂÖàÂØºÂá∫<code>kubeadm</code>ÈªòËÆ§ÁöÑÂêØÂä®ÈÖçÁΩÆÊñá‰ª∂„ÄÇ</p>
<p><code>kubeadm config print init-defaults &gt; kubeadm1.24.conf</code></p>
<p>ÁÑ∂ÂêéÂÅö‰∏Ä‰∫õ‰øÆÊîπÔºåÊàëÁöÑ‰øÆÊîπÂ¶Ç‰∏ãÔºö</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>apiVersion: kubeadm.k8s.io/v1beta3
</span></span><span style="display:flex;"><span>bootstrapTokens:
</span></span><span style="display:flex;"><span>- groups:
</span></span><span style="display:flex;"><span>  - system:bootstrappers:kubeadm:default-node-token
</span></span><span style="display:flex;"><span>  token: abcdef.0123456789abcdef
</span></span><span style="display:flex;"><span>  ttl: 24h0m0s
</span></span><span style="display:flex;"><span>  usages:
</span></span><span style="display:flex;"><span>  - signing
</span></span><span style="display:flex;"><span>  - authentication
</span></span><span style="display:flex;"><span>kind: InitConfiguration
</span></span><span style="display:flex;"><span>localAPIEndpoint:
</span></span><span style="display:flex;"><span>  advertiseAddress: 192.168.153.21
</span></span><span style="display:flex;"><span>  bindPort: <span style="color:#ae81ff">6443</span>
</span></span><span style="display:flex;"><span>nodeRegistration:
</span></span><span style="display:flex;"><span>  criSocket: unix:///var/run/cri-dockerd.sock
</span></span><span style="display:flex;"><span>  imagePullPolicy: IfNotPresent
</span></span><span style="display:flex;"><span>  name: nm
</span></span><span style="display:flex;"><span>  taints: null
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>apiServer:
</span></span><span style="display:flex;"><span>  timeoutForControlPlane: 4m0s
</span></span><span style="display:flex;"><span>apiVersion: kubeadm.k8s.io/v1beta3
</span></span><span style="display:flex;"><span>certificatesDir: /etc/kubernetes/pki
</span></span><span style="display:flex;"><span>clusterName: kubernetes
</span></span><span style="display:flex;"><span>controllerManager: <span style="color:#f92672">{}</span>
</span></span><span style="display:flex;"><span>dns: <span style="color:#f92672">{}</span>
</span></span><span style="display:flex;"><span>etcd:
</span></span><span style="display:flex;"><span>  local:
</span></span><span style="display:flex;"><span>    dataDir: /var/lib/etcd
</span></span><span style="display:flex;"><span>imageRepository: registry.aliyuncs.com/google_containers
</span></span><span style="display:flex;"><span>kind: ClusterConfiguration
</span></span><span style="display:flex;"><span>kubernetesVersion: 1.24.0
</span></span><span style="display:flex;"><span>networking:
</span></span><span style="display:flex;"><span>  dnsDomain: cluster.local
</span></span><span style="display:flex;"><span>  serviceSubnet: 10.96.0.0/12
</span></span><span style="display:flex;"><span>  podSubnet: 10.5.0.0/16
</span></span><span style="display:flex;"><span>scheduler: <span style="color:#f92672">{}</span>
</span></span></code></pre></div><p>ÈúÄË¶ÅÊ≥®ÊÑèÁöÑÂá†‰∏™ÁÇπÊúâÔºö</p>
<ul>
<li><code>advertiseAddress: 192.168.153.21</code>ÔºöËÆæÁΩÆÊéßÂà∂Âπ≥Èù¢API ServerÁöÑÂú∞ÂùÄÂíåÁ´ØÂè£„ÄÇ</li>
<li><code>criSocket: unix:///var/run/cri-dockerd.sock</code>ÔºöËøôÈúÄË¶ÅÁâπÂà´Ê≥®ÊÑèÔºåcriSocketÂ∞±ÊòØ‰∏äÈù¢Êàë‰ª¨ËØ¥ÁöÑcri-dockerd‰∏≠ÁöÑ<code>--container-runtime-endpoint</code>ÂèÇÊï∞ÔºåÂ¶ÇÊûú‰ΩøÁî®‰∫ÜÂà´ÁöÑÂÆπÂô®ËøêË°åÊó∂ËøôÈáå‰πüË¶ÅÁõ∏Â∫î‰øÆÊîπ„ÄÇ</li>
<li><code>name: nm</code>ÔºöÊú¨Êú∫ÁöÑhostname„ÄÇ</li>
<li><code>imageRepository: registry.aliyuncs.com/google_containers</code>ÔºöÂõΩÂÜÖÁî®aliyunÁöÑÈïúÂÉè„ÄÇ</li>
<li><code>podSubnet: 10.5.0.0/16</code>ÔºöPod cidr‰ø°ÊÅØ„ÄÇ</li>
</ul>
<h3 id="ÂêØÂä®ÈõÜÁæ§ÂêØÂä®Â§±Ë¥•">ÂêØÂä®ÈõÜÁæ§(ÂêØÂä®Â§±Ë¥•)</h3>
<p>ÁÑ∂ÂêéÊàë‰ª¨Â∞ùËØïÂêØÂä®ÈõÜÁæ§Ôºö</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e"># kubeadm init --config ../create-cluster/kubeadm1.24.conf </span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>init<span style="color:#f92672">]</span> Using Kubernetes version: v1.24.0
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>preflight<span style="color:#f92672">]</span> Running pre-flight checks
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">[</span>WARNING SystemVerification<span style="color:#f92672">]</span>: missing optional cgroups: blkio
</span></span><span style="display:flex;"><span>error execution phase preflight: <span style="color:#f92672">[</span>preflight<span style="color:#f92672">]</span> Some fatal errors occurred:
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">[</span>ERROR CRI<span style="color:#f92672">]</span>: container runtime is not running: output: time<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;2022-07-31T15:41:42+08:00&#34;</span> level<span style="color:#f92672">=</span>debug msg<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;get runtime connection&#34;</span>
</span></span><span style="display:flex;"><span>time<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;2022-07-31T15:41:42+08:00&#34;</span> level<span style="color:#f92672">=</span>fatal msg<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;unable to determine runtime API version: rpc error: code = Unavailable desc = connection error: desc = \&#34;transport: Error while dialing dial unix /var/run/cri-dockerd.sock: connect: connection refused\&#34;&#34;</span>
</span></span><span style="display:flex;"><span>, error: exit status <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>preflight<span style="color:#f92672">]</span> If you know what you are doing, you can make a check non-fatal with <span style="color:#e6db74">`</span>--ignore-preflight-errors<span style="color:#f92672">=</span>...<span style="color:#e6db74">`</span>
</span></span><span style="display:flex;"><span>To see the stack trace of this error execute with --v<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span> or higher
</span></span></code></pre></div><p>ÂèëÁé∞Êä•Èîô‰∫Ü<code>level=fatal msg=&quot;unable to determine runtime API version: rpc error: code = Unavailable desc = connection error: desc = \&quot;transport: Error while dialing dial unix /var/run/cri-dockerd.sock: connect: connection refused\&quot;</code>„ÄÇÊàë‰ª¨ÁöÑsocketÊ≤°ÊúâËøû‰∏ä„ÄÇ</p>
<p>ÂéüÂõ†Â∞±ÊòØÔºå<strong>Êàë‰ª¨ÂÆâË£Ö‰∫Ücri-dockerdÂêéÔºåÂÆÉÂπ∂‰∏ç‰ºöÂÉèsystemctlÊâÄÁÆ°ÁêÜÁöÑserviceÔºåÊàñËÄÖÂÆàÊä§ËøõÁ®ãÈÇ£Ê†∑Ëá™Âä®È©ªÁïôÂú®Êú¨Êú∫‰∏ä„ÄÇÊàë‰ª¨ÂøÖÈ°ªÊâãÂä®ÁöÑÂêØÂä®cri-dockerd„ÄÇ</strong></p>
<p>ÊâÄ‰ª•ÔºåÈúÄË¶ÅÊâãÂä®ËøêË°åcri-dockerdÔºåÂπ∂‰∏îÊ∑ªÂä†<code>--pod-infra-container-image</code>ÂèÇÊï∞„ÄÇÔºà‰ΩøÁî®<code>kubeadm config images list --config kubeadm1.24.conf</code>ÂèØ‰ª•Áü•ÈÅìÈúÄË¶ÅÁöÑÈïúÂÉèÁâàÊú¨Ôºâ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>&gt; cri-dockerd --pod-infra-container-image<span style="color:#f92672">=</span>registry.aliyuncs.com/google_containers/pause:3.7
</span></span><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> Connecting to docker on the Endpoint unix:///var/run/docker.sock 
</span></span><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> Start docker client with request timeout 0s  
</span></span><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> Hairpin mode is set to none                  
</span></span><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> Docker cri networking managed by network plugin kubernetes.io/no-op 
</span></span><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> Docker Info: &amp;<span style="color:#f92672">{</span>ID:HEPZ:PXCZ:XHZR:SKBX:TJL5:EG5L:U6P3:PI5A:PVZZ:ASKB:QJUC:QEDR Containers:2 ContainersRunning:1 ContainersPaused:0 ContainersStopped:1 Images:13 Driver:overlay2 DriverStatus:<span style="color:#f92672">[[</span>Backing Filesystem extfs<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>Supports d_type true<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>Native Overlay Diff true<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>userxattr false<span style="color:#f92672">]]</span> SystemStatus:<span style="color:#f92672">[]</span> Plugins:<span style="color:#f92672">{</span>Volume:<span style="color:#f92672">[</span>local<span style="color:#f92672">]</span> Network:<span style="color:#f92672">[</span>bridge host ipvlan macvlan null overlay<span style="color:#f92672">]</span> Authorization:<span style="color:#f92672">[]</span> Log:<span style="color:#f92672">[</span>awslogs fluentd gcplogs gelf journald json-file local logentries splunk syslog<span style="color:#f92672">]}</span> MemoryLimit:true SwapLimit:true KernelMemory:false KernelMemoryTCP:false CPUCfsPeriod:true CPUCfsQuota:true CPUShares:true CPUSet:true PidsLimit:true IPv4Forwarding:true BridgeNfIptables:true BridgeNfIP6tables:true Debug:false NFd:31 OomKillDisable:false NGoroutines:39 SystemTime:2022-07-31T15:49:40.481000763+08:00 LoggingDriver:json-file CgroupDriver:systemd NEventsListener:0 KernelVersion:5.15.0-41-generic OperatingSystem:Ubuntu 22.04 LTS OSType:linux Architecture:x86_64 IndexServerAddress:https://index.docker.io/v1/ RegistryConfig:0xc0001de540 NCPU:4 MemTotal:8302116864 GenericResources:<span style="color:#f92672">[]</span> DockerRootDir:/var/lib/docker HTTPProxy: HTTPSProxy: NoProxy: Name:nm Labels:<span style="color:#f92672">[]</span> ExperimentalBuild:false ServerVersion:20.10.17 ClusterStore: ClusterAdvertise: Runtimes:map<span style="color:#f92672">[</span>io.containerd.runc.v2:<span style="color:#f92672">{</span>Path:runc Args:<span style="color:#f92672">[]}</span> io.containerd.runtime.v1.linux:<span style="color:#f92672">{</span>Path:runc Args:<span style="color:#f92672">[]}</span> runc:<span style="color:#f92672">{</span>Path:runc Args:<span style="color:#f92672">[]}]</span> DefaultRuntime:runc Swarm:<span style="color:#f92672">{</span>NodeID: NodeAddr: LocalNodeState:inactive ControlAvailable:false Error: RemoteManagers:<span style="color:#f92672">[]</span> Nodes:0 Managers:0 Cluster:&lt;nil&gt; Warnings:<span style="color:#f92672">[]}</span> LiveRestoreEnabled:false Isolation: InitBinary:docker-init ContainerdCommit:<span style="color:#f92672">{</span>ID:10c12954828e7c7c9b6e0ea9b0c02b01407d3ae1 Expected:10c12954828e7c7c9b6e0ea9b0c02b01407d3ae1<span style="color:#f92672">}</span> RuncCommit:<span style="color:#f92672">{</span>ID:v1.1.2-0-ga916309 Expected:v1.1.2-0-ga916309<span style="color:#f92672">}</span> InitCommit:<span style="color:#f92672">{</span>ID:de40ad0 Expected:de40ad0<span style="color:#f92672">}</span> SecurityOptions:<span style="color:#f92672">[</span>name<span style="color:#f92672">=</span>apparmor name<span style="color:#f92672">=</span>seccomp,profile<span style="color:#f92672">=</span>default name<span style="color:#f92672">=</span>cgroupns<span style="color:#f92672">]</span> ProductLicense: Warnings:<span style="color:#f92672">[]}</span> 
</span></span><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> Setting cgroupDriver systemd                 
</span></span><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> Docker cri received runtime config &amp;RuntimeConfig<span style="color:#f92672">{</span>NetworkConfig:&amp;NetworkConfig<span style="color:#f92672">{</span>PodCidr:,<span style="color:#f92672">}</span>,<span style="color:#f92672">}</span> 
</span></span><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> Starting the GRPC backend <span style="color:#66d9ef">for</span> the Docker CRI interface. 
</span></span><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> Start cri-dockerd grpc backend
</span></span></code></pre></div><p>Êàë‰ª¨ÁúãÂà∞ÔºåÂÆÉÂ∑≤ÁªèËøû‰∏ä‰∫ÜdockerÁöÑendpoint„ÄÇ</p>
<p>ËøôÊó∂Êàë‰ª¨ÂÜçÂè¶Ëµ∑‰∏Ä‰∏™ÁªàÁ´ØÔºåÂêØÂä®ÈõÜÁæ§„ÄÇ</p>
<blockquote>
<p>ÈúÄË¶ÅÊ≥®ÊÑèÔºåÂú®Ê∏ÖÁêÜÈõÜÁæ§Êó∂ÔºåË¶ÅÊ∑ªÂä†‰∏Ä‰∏™socketÂèÇÊï∞ÔºåÂ¶Ç<code>kubeadm reset --cri-socket unix:///var/run/cri-dockerd.sock</code>„ÄÇ</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>&gt; kubeadm init --config kubeadm1.24.3.conf 
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>init<span style="color:#f92672">]</span> Using Kubernetes version: v1.24.0
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>preflight<span style="color:#f92672">]</span> Running pre-flight checks
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">[</span>WARNING SystemVerification<span style="color:#f92672">]</span>: missing optional cgroups: blkio
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>preflight<span style="color:#f92672">]</span> Pulling images required <span style="color:#66d9ef">for</span> setting up a Kubernetes cluster
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>preflight<span style="color:#f92672">]</span> This might take a minute or two, depending on the speed of your internet connection
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>preflight<span style="color:#f92672">]</span> You can also perform this action in beforehand using <span style="color:#e6db74">&#39;kubeadm config images pull&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>certs<span style="color:#f92672">]</span> Using certificateDir folder <span style="color:#e6db74">&#34;/etc/kubernetes/pki&#34;</span>
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><p>Âú®cri-dockerdÁöÑÁªàÁ´Ø‰∏≠ÔºåÊúâ‰∫ÜÊñ∞ÁöÑËæìÂá∫Ôºö</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> Start cri-dockerd grpc backend               
</span></span><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>0157<span style="color:#f92672">]</span> Will attempt to re-write config file /var/lib/docker/containers/000f099fa98530c39e69458881c051f25200feb4f25dfd3d8f02f7444e6763ac/resolv.conf as <span style="color:#f92672">[</span>nameserver 192.168.153.2 nameserver 192.168.153.2 search <span style="color:#f92672">]</span> 
</span></span><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>0157<span style="color:#f92672">]</span> Will attempt to re-write config file /var/lib/docker/containers/ed0aa34e77adbf4ff444998b75e2365f1ebe44e831cdf4c55d3eecd4b6582958/resolv.conf as <span style="color:#f92672">[</span>nameserver 192.168.153.2 nameserver 192.168.153.2 search <span style="color:#f92672">]</span> 
</span></span><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>0157<span style="color:#f92672">]</span> Will attempt to re-write config file /var/lib/docker/containers/3431d46d839451adc30f1c44994990daed5b24899959aae34b5cfd3d5c695fc6/resolv.conf as <span style="color:#f92672">[</span>nameserver 192.168.153.2 nameserver 192.168.153.2 search <span style="color:#f92672">]</span> 
</span></span><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>0157<span style="color:#f92672">]</span> Will attempt to re-write config file /var/lib/docker/containers/50ae6ccb6e7c1420f58c1873bf2c17e291a26597a3b042b0df86a1ef2729470c/resolv.conf as <span style="color:#f92672">[</span>nameserver 192.168.153.2 nameserver 192.168.153.2 search <span style="color:#f92672">]</span> 
</span></span><span style="display:flex;"><span>ERRO<span style="color:#f92672">[</span>0167<span style="color:#f92672">]</span> ContainerStats resp: <span style="color:#f92672">{</span>0xc00098ea80 linux<span style="color:#f92672">}</span>    
</span></span><span style="display:flex;"><span>ERRO<span style="color:#f92672">[</span>0168<span style="color:#f92672">]</span> ContainerStats resp: <span style="color:#f92672">{</span>0xc00098f440 linux<span style="color:#f92672">}</span>    
</span></span><span style="display:flex;"><span>ERRO<span style="color:#f92672">[</span>0168<span style="color:#f92672">]</span> ContainerStats resp: <span style="color:#f92672">{</span>0xc000791b00 linux<span style="color:#f92672">}</span>    
</span></span></code></pre></div><p>ÁÑ∂ËÄåËøôÈáåËøòÊä•Âá∫‰∏Ä‰∫õÂ•áÊÄ™ÁöÑÈîôËØØ„ÄÇ</p>
<p>Êàë‰ª¨Êü•ÁúãdockerÂÆπÂô®Ôºö</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&gt; docker container ls
</span></span><span style="display:flex;"><span>CONTAINER ID   IMAGE                                               COMMAND                  CREATED         STATUS         PORTS                                       NAMES
</span></span><span style="display:flex;"><span>bbded4be83db   a4ca41631cc7                                        <span style="color:#e6db74">&#34;/coredns -conf /etc‚Ä¶&#34;</span>   <span style="color:#ae81ff">2</span> minutes ago   Up <span style="color:#ae81ff">2</span> minutes                                               k8s_coredns_coredns-74586cf9b6-s6n6g_kube-system_68e930db-ac76-4995-bef2-a9f094b5cf88_0
</span></span><span style="display:flex;"><span>173154bfdc43   a4ca41631cc7                                        <span style="color:#e6db74">&#34;/coredns -conf /etc‚Ä¶&#34;</span>   <span style="color:#ae81ff">2</span> minutes ago   Up <span style="color:#ae81ff">2</span> minutes                                               k8s_coredns_coredns-74586cf9b6-wstwx_kube-system_178e7a4e-3c35-42e6-b78b-1053274d9d4d_0
</span></span><span style="display:flex;"><span>fb2810fe84a3   77b49675beae                                        <span style="color:#e6db74">&#34;/usr/local/bin/kube‚Ä¶&#34;</span>   <span style="color:#ae81ff">2</span> minutes ago   Up <span style="color:#ae81ff">2</span> minutes                                               k8s_kube-proxy_kube-proxy-fpfq7_kube-system_3a52d7e5-ffa8-4193-a2de-948861818bf0_0
</span></span><span style="display:flex;"><span>640f6546ff97   registry.aliyuncs.com/google_containers/pause:3.7   <span style="color:#e6db74">&#34;/pause&#34;</span>                 <span style="color:#ae81ff">2</span> minutes ago   Up <span style="color:#ae81ff">2</span> minutes                                               k8s_POD_coredns-74586cf9b6-s6n6g_kube-system_68e930db-ac76-4995-bef2-a9f094b5cf88_0
</span></span><span style="display:flex;"><span>8933a7f18e54   registry.aliyuncs.com/google_containers/pause:3.7   <span style="color:#e6db74">&#34;/pause&#34;</span>                 <span style="color:#ae81ff">2</span> minutes ago   Up <span style="color:#ae81ff">2</span> minutes                                               k8s_POD_coredns-74586cf9b6-wstwx_kube-system_178e7a4e-3c35-42e6-b78b-1053274d9d4d_0
</span></span><span style="display:flex;"><span>c2319d389da4   registry.aliyuncs.com/google_containers/pause:3.7   <span style="color:#e6db74">&#34;/pause&#34;</span>                 <span style="color:#ae81ff">2</span> minutes ago   Up <span style="color:#ae81ff">2</span> minutes                                               k8s_POD_kube-proxy-fpfq7_kube-system_3a52d7e5-ffa8-4193-a2de-948861818bf0_0
</span></span><span style="display:flex;"><span>c441aae26e22   88784fb4ac2f                                        <span style="color:#e6db74">&#34;kube-controller-man‚Ä¶&#34;</span>   <span style="color:#ae81ff">2</span> minutes ago   Up <span style="color:#ae81ff">2</span> minutes                                               k8s_kube-controller-manager_kube-controller-manager-nm_kube-system_0b57267fec9fa21f5d899c064341d122_0
</span></span><span style="display:flex;"><span>c2251251c6be   e3ed7dee73e9                                        <span style="color:#e6db74">&#34;kube-scheduler --au‚Ä¶&#34;</span>   <span style="color:#ae81ff">2</span> minutes ago   Up <span style="color:#ae81ff">2</span> minutes                                               k8s_kube-scheduler_kube-scheduler-nm_kube-system_4b1a2622b0a7caad68556441288e8374_0
</span></span><span style="display:flex;"><span>90df81c294fc   aebe758cef4c                                        <span style="color:#e6db74">&#34;etcd --advertise-cl‚Ä¶&#34;</span>   <span style="color:#ae81ff">2</span> minutes ago   Up <span style="color:#ae81ff">2</span> minutes                                               k8s_etcd_etcd-nm_kube-system_c305f8ecb58a3de0b142aa31e3c6e6cc_0
</span></span><span style="display:flex;"><span>d14f4a822e37   529072250ccc                                        <span style="color:#e6db74">&#34;kube-apiserver --ad‚Ä¶&#34;</span>   <span style="color:#ae81ff">2</span> minutes ago   Up <span style="color:#ae81ff">2</span> minutes                                               k8s_kube-apiserver_kube-apiserver-nm_kube-system_a38fd4cf236ff9d9bba5bb8f006ffdfd_0
</span></span><span style="display:flex;"><span>000f099fa985   registry.aliyuncs.com/google_containers/pause:3.7   <span style="color:#e6db74">&#34;/pause&#34;</span>                 <span style="color:#ae81ff">2</span> minutes ago   Up <span style="color:#ae81ff">2</span> minutes                                               k8s_POD_kube-scheduler-nm_kube-system_4b1a2622b0a7caad68556441288e8374_0
</span></span><span style="display:flex;"><span>50ae6ccb6e7c   registry.aliyuncs.com/google_containers/pause:3.7   <span style="color:#e6db74">&#34;/pause&#34;</span>                 <span style="color:#ae81ff">2</span> minutes ago   Up <span style="color:#ae81ff">2</span> minutes                                               k8s_POD_kube-controller-manager-nm_kube-system_0b57267fec9fa21f5d899c064341d122_0
</span></span><span style="display:flex;"><span>ed0aa34e77ad   registry.aliyuncs.com/google_containers/pause:3.7   <span style="color:#e6db74">&#34;/pause&#34;</span>                 <span style="color:#ae81ff">2</span> minutes ago   Up <span style="color:#ae81ff">2</span> minutes                                               k8s_POD_kube-apiserver-nm_kube-system_a38fd4cf236ff9d9bba5bb8f006ffdfd_0
</span></span><span style="display:flex;"><span>3431d46d8394   registry.aliyuncs.com/google_containers/pause:3.7   <span style="color:#e6db74">&#34;/pause&#34;</span>                 <span style="color:#ae81ff">2</span> minutes ago   Up <span style="color:#ae81ff">2</span> minutes                                               k8s_POD_etcd-nm_kube-system_c305f8ecb58a3de0b142aa31e3c6e6cc_0
</span></span></code></pre></div><p>Á≥ªÁªüÁöÑÁªÑ‰ª∂ÈÉΩÂêØÂä®‰∫Ü„ÄÇ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&gt; kubectl get cs
</span></span><span style="display:flex;"><span>Warning: v1 ComponentStatus is deprecated in v1.19+
</span></span><span style="display:flex;"><span>NAME                 STATUS    MESSAGE                         ERROR
</span></span><span style="display:flex;"><span>scheduler            Healthy   ok                              
</span></span><span style="display:flex;"><span>controller-manager   Healthy   ok                              
</span></span><span style="display:flex;"><span>etcd-0               Healthy   <span style="color:#f92672">{</span><span style="color:#e6db74">&#34;health&#34;</span>:<span style="color:#e6db74">&#34;true&#34;</span>,<span style="color:#e6db74">&#34;reason&#34;</span>:<span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">}</span>   
</span></span><span style="display:flex;"><span>&gt; kubectl get pod -A
</span></span><span style="display:flex;"><span>NAMESPACE     NAME                         READY   STATUS    RESTARTS   AGE
</span></span><span style="display:flex;"><span>kube-system   coredns-74586cf9b6-vpdp5     1/1     Running   <span style="color:#ae81ff">0</span>          33s
</span></span><span style="display:flex;"><span>kube-system   coredns-74586cf9b6-zdfpw     1/1     Running   <span style="color:#ae81ff">0</span>          33s
</span></span><span style="display:flex;"><span>kube-system   etcd-nm                      1/1     Running   <span style="color:#ae81ff">0</span>          46s
</span></span><span style="display:flex;"><span>kube-system   kube-apiserver-nm            1/1     Running   <span style="color:#ae81ff">0</span>          49s
</span></span><span style="display:flex;"><span>kube-system   kube-controller-manager-nm   1/1     Running   <span style="color:#ae81ff">0</span>          49s
</span></span><span style="display:flex;"><span>kube-system   kube-proxy-gs9lq             1/1     Running   <span style="color:#ae81ff">0</span>          33s
</span></span><span style="display:flex;"><span>kube-system   kube-scheduler-nm            1/1     Running   <span style="color:#ae81ff">0</span>          46s
</span></span></code></pre></div><p>Âä†ÂÖ•Â∑•‰ΩúËäÇÁÇπ„ÄÇ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>&gt; kubeadm join 192.168.153.21:6443 --token abcdef.0123456789abcdef <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>        --discovery-token-ca-cert-hash sha256:d1902aa47f486d6fd1d35f7fb92286ffaa39da0437ded9be8d2de5670d52a8ca
</span></span><span style="display:flex;"><span>Found multiple CRI endpoints on the host. Please define which one <span style="color:#66d9ef">do</span> you wish to use by setting the <span style="color:#e6db74">&#39;criSocket&#39;</span> field in the kubeadm configuration file: unix:///var/run/containerd/containerd.sock, unix:///var/run/cri-dockerd.sock
</span></span></code></pre></div><p>Êàë‰ª¨ÂèëÁé∞ËøôÈáåÂá∫Áé∞‰∫ÜËøêË°åÊó∂ÂÜ≤Á™ÅÔºåÈúÄË¶ÅÊåáÂÆöÔºåËøôÈáåÂ∞±Áõ¥Êé•Âú®ÂëΩ‰ª§Ë°åÊåáÊòéÔºåÂ¶Ç‰∏ãÔºö</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>&gt; kubeadm join 192.168.153.21:6443 --token abcdef.0123456789abcdef --discovery-token-ca-cert-hash sha256:d1902aa47f486d6fd1d35f7fb92286ffaa39da0437ded9be8d2de5670d52a8ca --cri-socket unix:///var/run/cri-dockerd.sock
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>preflight<span style="color:#f92672">]</span> Running pre-flight checks
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">[</span>WARNING SystemVerification<span style="color:#f92672">]</span>: missing optional cgroups: blkio
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>preflight<span style="color:#f92672">]</span> Reading configuration from the cluster...
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>preflight<span style="color:#f92672">]</span> FYI: You can look at this config file with <span style="color:#e6db74">&#39;kubectl -n kube-system get cm kubeadm-config -o yaml&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>kubelet-start<span style="color:#f92672">]</span> Writing kubelet configuration to file <span style="color:#e6db74">&#34;/var/lib/kubelet/config.yaml&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>kubelet-start<span style="color:#f92672">]</span> Writing kubelet environment file with flags to file <span style="color:#e6db74">&#34;/var/lib/kubelet/kubeadm-flags.env&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>kubelet-start<span style="color:#f92672">]</span> Starting the kubelet
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>kubelet-start<span style="color:#f92672">]</span> Waiting <span style="color:#66d9ef">for</span> the kubelet to perform the TLS Bootstrap...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>This node has joined the cluster:
</span></span><span style="display:flex;"><span>* Certificate signing request was sent to apiserver and a response was received.
</span></span><span style="display:flex;"><span>* The Kubelet was informed of the new secure connection details.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Run <span style="color:#e6db74">&#39;kubectl get nodes&#39;</span> on the control-plane to see this node join the cluster.
</span></span></code></pre></div><p>ÁÑ∂ÂêéÔºåÊàë‰ª¨ÁúãÂà∞ËäÇÁÇπÂ∑≤Âä†ÂÖ•ÈõÜÁæ§Ôºö</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&gt; kubectl get nodes
</span></span><span style="display:flex;"><span>NAME   STATUS   ROLES           AGE     VERSION
</span></span><span style="display:flex;"><span>na     Ready    &lt;none&gt;          2m14s   v1.24.3
</span></span><span style="display:flex;"><span>nb     Ready    &lt;none&gt;          24s     v1.24.3
</span></span><span style="display:flex;"><span>nm     Ready    control-plane   7m33s   v1.24.3
</span></span></code></pre></div><p><strong>ËøôÈáåÊàë‰∏çËß£ÁöÑÊòØÔºå‰πãÂâçËÆæÁΩÆCNIÂâçÔºåcore-dnsÁöÑÁä∂ÊÄÅÊòØpendingÔºåËÄå‰∏îËäÇÁÇπÁä∂ÊÄÅ‰πüÊòØNot Ready„ÄÇ‰ΩÜÊòØÁé∞Âú®Âç¥Áúã‰ºº‰∏ÄÂàáÊ≠£Â∏∏„ÄÇ</strong></p>
<p>Êàë‰ª¨ÂÖà‰ΩøÁî®ÁÆÄÂçïÁöÑflannelÂÅöÈõÜÁæ§ÁΩëÁªúÔºåÊ≥®ÊÑè‰∏çË¶ÅÂøòËÆ∞‰øÆÊîπcidr‰∏∫ÈõÜÁæ§ÂàõÂª∫Êó∂ÊåáÂÆöÁöÑ„ÄÇ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>&gt; kubectl get pods -A
</span></span><span style="display:flex;"><span>NAMESPACE      NAME                         READY   STATUS    RESTARTS   AGE
</span></span><span style="display:flex;"><span>kube-flannel   kube-flannel-ds-5v2vn        1/1     Running   <span style="color:#ae81ff">0</span>          41s
</span></span><span style="display:flex;"><span>kube-flannel   kube-flannel-ds-bcgwm        1/1     Running   <span style="color:#ae81ff">0</span>          41s
</span></span><span style="display:flex;"><span>kube-flannel   kube-flannel-ds-ctt4v        1/1     Running   <span style="color:#ae81ff">0</span>          41s
</span></span><span style="display:flex;"><span>kube-system    coredns-74586cf9b6-vpdp5     1/1     Running   <span style="color:#ae81ff">0</span>          14m
</span></span><span style="display:flex;"><span>kube-system    coredns-74586cf9b6-zdfpw     1/1     Running   <span style="color:#ae81ff">0</span>          14m
</span></span><span style="display:flex;"><span>kube-system    etcd-nm                      1/1     Running   <span style="color:#ae81ff">0</span>          15m
</span></span><span style="display:flex;"><span>kube-system    kube-apiserver-nm            1/1     Running   <span style="color:#ae81ff">0</span>          15m
</span></span><span style="display:flex;"><span>kube-system    kube-controller-manager-nm   1/1     Running   <span style="color:#ae81ff">0</span>          15m
</span></span><span style="display:flex;"><span>kube-system    kube-proxy-6px66             1/1     Running   <span style="color:#ae81ff">0</span>          9m56s
</span></span><span style="display:flex;"><span>kube-system    kube-proxy-cc4fw             1/1     Running   <span style="color:#ae81ff">0</span>          8m6s
</span></span><span style="display:flex;"><span>kube-system    kube-proxy-gs9lq             1/1     Running   <span style="color:#ae81ff">0</span>          14m
</span></span><span style="display:flex;"><span>kube-system    kube-scheduler-nm            1/1     Running   <span style="color:#ae81ff">0</span>          15m
</span></span></code></pre></div><p>ÁΩëÁªúCNI‰πüÊ≠£Â∏∏Â∑•‰Ωú‰∫Ü„ÄÇ</p>
<p>ÁÑ∂ÂêéÊàë‰ª¨ÈÉ®ÁΩ≤‰∏Ä‰∏™ÁÆÄÂçïÁöÑÂæÆÊúçÂä°Â∫îÁî®ËØïËØï„ÄÇ</p>
<p>Áúã‰ºº‰∏ÄÂàáÊ≠£Â∏∏Ôºå‰ΩÜÊòØÊàëÂèëÁé∞ÈõÜÁæ§ÁΩëÁªúÂá∫Áé∞ÈóÆÈ¢òÔºå‰∏çËÉΩËÆøÈóÆserviceÁöÑÊúçÂä°„ÄÇËÄå‰∏îÈÄöËøá<code>-o wide</code>Êü•ÁúãPodÂèëÁé∞‰ªñ‰ª¨Âπ∂‰∏çÂú®ÊàëÊâÄÊåáÂÆöÁöÑCIDRÁΩëÊÆµÔºåËÄåÊòØÂú®‰∏Ä‰∏™Â•áÊÄ™ÁöÑ172ÁΩëÊÆµ„ÄÇ</p>
<p>ÁªìÂêà‰∏äÈù¢ÁöÑÔºå‚ÄúËøòÊ≤°ÊúâÈÉ®ÁΩ≤CNIËäÇÁÇπÂíåcore-dnsÂ∞±Ready‚ÄùËøô‰∏™Â•áÊÄ™ÁöÑÁé∞Ë±°„ÄÇÊàëËÆ§‰∏∫cri-dockerdÁöÑÁΩëÁªúÈÖçÁΩÆÊúâÈóÆÈ¢ò„ÄÇ‰∫éÊòØÊàëÂèàËØ¶ÁªÜÊü•ÁúãÁöÑÂèÇËÄÉËµÑÊñôÔºåÂèëÁé∞Êúâ‰∏Ä‰∏™ÈÖçÁΩÆÂíåÂèÇËÄÉËµÑÊñô‰∏≠ÁöÑ‰∏ç‰∏ÄÊ†∑„ÄÇ</p>
<p>Âπ∂‰∏îÊàë‰ª¨ËØ¶ÁªÜÊü•Áúã‰∏äÈù¢ÁöÑcri-dockerÂêØÂä®Êó•ÂøóÔºö</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> Docker cri networking managed by network plugin kubernetes.io/no-op
</span></span></code></pre></div><p>cri-dockerdÁöÑÁΩëÁªúÊòØÁî±<code>network plugin kubernetes.io/no-op</code>ÁÆ°ÁêÜÁöÑÔºåËøôÊòØ‰∏™Âï•Ôºü</p>
<h3 id="cni">CNI</h3>
<p>ÊâÄ‰ª•ÔºåËøôÈáåÂ∞±‰∏çÂæó‰∏çËÆ®ËÆ∫‰∏ãkubernetes1.24‰πãÂêéÁöÑÂè¶‰∏Ä‰∏™ÈáçÂ§ßÊîπÂèòÔºö<strong>Âú® Kubernetes 1.24 ‰πãÂâçÔºåCNI Êèí‰ª∂‰πüÂèØ‰ª•Áî± kubelet ‰ΩøÁî®ÂëΩ‰ª§Ë°åÂèÇÊï∞ <code>cni-bin-dir</code> Âíå <code>network-plugin</code> ÁÆ°ÁêÜ„ÄÇKubernetes 1.24 ÁßªÈô§‰∫ÜËøô‰∫õÂëΩ‰ª§Ë°åÂèÇÊï∞Ôºå CNI ÁöÑÁÆ°ÁêÜ‰∏çÂÜçÊòØ kubelet ÁöÑÂ∑•‰Ωú„ÄÇ</strong></p>
<p>‰πüÂ∞±ÊòØËØ¥ÔºåkubeletÂ∑≤Áªè‰ªéÁÆ°ÁêÜCNI‰∏≠ÂæóÂà∞‰∫ÜËß£Êîæ„ÄÇË∞ÅÊù•ÁÆ°ÁêÜcniÂë¢Ôºü</p>
<p>ÂÆπÂô®ËøêË°åÊó∂„ÄÇ</p>
<p>ÂèàÂõûÂà∞ÂèÇËÄÉËµÑÊñô‰∏≠ÂØπcri-dockerdÁöÑÈÖçÁΩÆÔºåÊòØËøôÊ†∑ÂÜôÁöÑÔºö</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>ExecStart<span style="color:#f92672">=</span>/usr/bin/cri-dockerd --network-plugin<span style="color:#f92672">=</span>cni --pod-infra-container-image<span style="color:#f92672">=</span>registry.aliyuncs.com/google_containers/pause:3.7
</span></span></code></pre></div><p>ÂØπ<code>--network-plugin=cni</code>ËøõË°å‰∫ÜÈÖçÁΩÆ„ÄÇ‰∏äËø∞cri-dockerdÁöÑÂêØÂä®ÂèÇÊï∞‰∏≠ÔºåÊúâ‰∏ÄÂè•Ôºö</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>--network-plugin string                   &lt;Warning: Alpha feature&gt; The name of the network plugin to be invoked <span style="color:#66d9ef">for</span> various events in kubelet/pod lifecycle.
</span></span></code></pre></div><p>‰∫éÊòØÊàëÊåâÁÖßËøô‰∏™ÊèêÁ§∫ÊâæÂà∞‰∏ÄÁØáËß£ËØªkubeletÈÖçÁΩÆcniÁöÑÂçöÊñáÔºåWarningËøôÂè•ËØùÊ≠£ÊòØÂéüÊù•Âú®kubelet‰ª£Á†Å‰∏≠ÁöÑÔºàËßÅ<a class="link" href="https://www.cnblogs.com/lianngkyle/p/15171630.html"  target="_blank" rel="noopener"
    >kubernetes/k8s CNIÂàÜÊûê-ÂÆπÂô®ÁΩëÁªúÊé•Âè£ÂàÜÊûê</a>Ôºâ„ÄÇ</p>
<p>kubeletÁΩëÁªúÊèí‰ª∂Êúâ‰∏ãÈù¢‰∏âÁßçÁ±ªÂûãÔºö</p>
<ul>
<li>cni</li>
<li>kubenet</li>
<li>noopÔºö‰∏çÈÖçÁΩÆÁΩëÁªúÊèí‰ª∂</li>
</ul>
<p>ËøôÊ†∑Êàë‰ª¨Â∞±ÊòéÁôΩ‰∫ÜÔºåÂú®ÊúÄÂàùÂêØÂä®cri-dockerdÁöÑÊó•ÂøóÂ∞±Ë°®Á§∫Êàë‰ª¨Âπ∂Ê≤°ÊúâÁªôcri-dockerdÈÖçÁΩÆÁΩëÁªúÊèí‰ª∂<code>INFO[0000] Docker cri networking managed by network plugin kubernetes.io/no-op</code>ÔºåÁªìÂêàÂÆÉÁöÑÂêØÂä®ÂèÇÊï∞<code>--network-plugin</code>ÔºåÂõ†Ê≠§Ëøô‰∏™ÈóÆÈ¢òÂ∫îËØ•Â∞±ÊòØÂá∫‰∫éÊ≠§„ÄÇ</p>
<h3 id="ÂÜçÊ¨°ÂêØÂä®ÈõÜÁæ§">ÂÜçÊ¨°ÂêØÂä®ÈõÜÁæ§</h3>
<p>Êàë‰ª¨ÂÖàÊ∏ÖÈô§ÈõÜÁæ§ÁéØÂ¢ÉÔºåÂåÖÊã¨flannelÁΩëÁªúÁéØÂ¢É„ÄÇ</p>
<p>Âú®ÂêØÂä®cri-dockerdÁöÑÂëΩ‰ª§‰∏≠Âä†‰∏äÁΩëÁªúÊèí‰ª∂ÂèÇÊï∞„ÄÇ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&gt; cri-dockerd --pod-infra-container-image<span style="color:#f92672">=</span>registry.aliyuncs.com/google_containers/pause:3.7 --network-plugin<span style="color:#f92672">=</span>cni
</span></span><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> Connecting to docker on the Endpoint unix:///var/run/docker.sock 
</span></span><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> Start docker client with request timeout 0s  
</span></span><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> Hairpin mode is set to none                  
</span></span><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> Loaded network plugin cni                    
</span></span><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> Docker cri networking managed by network plugin cni 
</span></span><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> Docker Info: &amp;<span style="color:#f92672">{</span>ID:HEPZ:PXCZ:XHZR:SKBX:TJL5:EG5L:U6P3:PI5A:PVZZ:ASKB:QJUC:QEDR Containers:16 ContainersRunning:12 ContainersPaused:0 ContainersStopped:4 Images:15 Driver:overlay2 DriverStatus:<span style="color:#f92672">[[</span>Backing Filesystem extfs<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>Supports d_type true<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>Native Overlay Diff true<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>userxattr false<span style="color:#f92672">]]</span> SystemStatus:<span style="color:#f92672">[]</span> Plugins:<span style="color:#f92672">{</span>Volume:<span style="color:#f92672">[</span>local<span style="color:#f92672">]</span> Network:<span style="color:#f92672">[</span>bridge host ipvlan macvlan null overlay<span style="color:#f92672">]</span> Authorization:<span style="color:#f92672">[]</span> Log:<span style="color:#f92672">[</span>awslogs fluentd gcplogs gelf journald json-file local logentries splunk syslog<span style="color:#f92672">]}</span> MemoryLimit:true SwapLimit:true KernelMemory:false KernelMemoryTCP:false CPUCfsPeriod:true CPUCfsQuota:true CPUShares:true CPUSet:true PidsLimit:true IPv4Forwarding:true BridgeNfIptables:true BridgeNfIP6tables:true Debug:false NFd:89 OomKillDisable:false NGoroutines:83 SystemTime:2022-07-31T16:59:32.329402283+08:00 LoggingDriver:json-file CgroupDriver:systemd NEventsListener:0 KernelVersion:5.15.0-41-generic OperatingSystem:Ubuntu 22.04 LTS OSType:linux Architecture:x86_64 IndexServerAddress:https://index.docker.io/v1/ RegistryConfig:0xc000468a10 NCPU:4 MemTotal:8302116864 GenericResources:<span style="color:#f92672">[]</span> DockerRootDir:/var/lib/docker HTTPProxy: HTTPSProxy: NoProxy: Name:nm Labels:<span style="color:#f92672">[]</span> ExperimentalBuild:false ServerVersion:20.10.17 ClusterStore: ClusterAdvertise: Runtimes:map<span style="color:#f92672">[</span>io.containerd.runc.v2:<span style="color:#f92672">{</span>Path:runc Args:<span style="color:#f92672">[]}</span> io.containerd.runtime.v1.linux:<span style="color:#f92672">{</span>Path:runc Args:<span style="color:#f92672">[]}</span> runc:<span style="color:#f92672">{</span>Path:runc Args:<span style="color:#f92672">[]}]</span> DefaultRuntime:runc Swarm:<span style="color:#f92672">{</span>NodeID: NodeAddr: LocalNodeState:inactive ControlAvailable:false Error: RemoteManagers:<span style="color:#f92672">[]</span> Nodes:0 Managers:0 Cluster:&lt;nil&gt; Warnings:<span style="color:#f92672">[]}</span> LiveRestoreEnabled:false Isolation: InitBinary:docker-init ContainerdCommit:<span style="color:#f92672">{</span>ID:10c12954828e7c7c9b6e0ea9b0c02b01407d3ae1 Expected:10c12954828e7c7c9b6e0ea9b0c02b01407d3ae1<span style="color:#f92672">}</span> RuncCommit:<span style="color:#f92672">{</span>ID:v1.1.2-0-ga916309 Expected:v1.1.2-0-ga916309<span style="color:#f92672">}</span> InitCommit:<span style="color:#f92672">{</span>ID:de40ad0 Expected:de40ad0<span style="color:#f92672">}</span> SecurityOptions:<span style="color:#f92672">[</span>name<span style="color:#f92672">=</span>apparmor name<span style="color:#f92672">=</span>seccomp,profile<span style="color:#f92672">=</span>default name<span style="color:#f92672">=</span>cgroupns<span style="color:#f92672">]</span> ProductLicense: Warnings:<span style="color:#f92672">[]}</span> 
</span></span><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> Setting cgroupDriver systemd                 
</span></span><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> Docker cri received runtime config &amp;RuntimeConfig<span style="color:#f92672">{</span>NetworkConfig:&amp;NetworkConfig<span style="color:#f92672">{</span>PodCidr:,<span style="color:#f92672">}</span>,<span style="color:#f92672">}</span> 
</span></span><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> Starting the GRPC backend <span style="color:#66d9ef">for</span> the Docker CRI interface. 
</span></span><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> Start cri-dockerd grpc backend     
</span></span></code></pre></div><p>ÂèØ‰ª•ÁúãÂà∞<code>INFO[0000] Loaded network plugin cni</code>„ÄÇ</p>
<p>Âú®Âè¶‰∏Ä‰∏™ÁªàÁ´ØÈáåÔºåÂàùÂßãÂåñÈõÜÁæ§ÔºåÂπ∂ÂÆâË£ÖflannelÊèí‰ª∂„ÄÇ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>&gt; kubectl get pods -A
</span></span><span style="display:flex;"><span>NAMESPACE     NAME                         READY   STATUS    RESTARTS   AGE
</span></span><span style="display:flex;"><span>kube-system   coredns-74586cf9b6-2p28x     0/1     Pending   <span style="color:#ae81ff">0</span>          46s
</span></span><span style="display:flex;"><span>kube-system   coredns-74586cf9b6-lkrn6     0/1     Pending   <span style="color:#ae81ff">0</span>          46s
</span></span><span style="display:flex;"><span>kube-system   etcd-nm                      1/1     Running   <span style="color:#ae81ff">0</span>          58s
</span></span><span style="display:flex;"><span>kube-system   kube-apiserver-nm            1/1     Running   <span style="color:#ae81ff">0</span>          58s
</span></span><span style="display:flex;"><span>kube-system   kube-controller-manager-nm   1/1     Running   <span style="color:#ae81ff">0</span>          59s
</span></span><span style="display:flex;"><span>kube-system   kube-proxy-qcgfk             1/1     Running   <span style="color:#ae81ff">0</span>          46s
</span></span><span style="display:flex;"><span>kube-system   kube-scheduler-nm            1/1     Running   <span style="color:#ae81ff">0</span>          58s
</span></span><span style="display:flex;"><span>&gt; kubectl get node
</span></span><span style="display:flex;"><span>NAME   STATUS     ROLES           AGE     VERSION
</span></span><span style="display:flex;"><span>na     NotReady   &lt;none&gt;          10s     v1.24.3
</span></span><span style="display:flex;"><span>nb     NotReady   &lt;none&gt;          13s     v1.24.3
</span></span><span style="display:flex;"><span>nm     NotReady   control-plane   2m34s   v1.24.3
</span></span><span style="display:flex;"><span>&gt; kubectl apply -f ../network/flannel.yaml 
</span></span><span style="display:flex;"><span>namespace/kube-flannel created
</span></span><span style="display:flex;"><span>clusterrole.rbac.authorization.k8s.io/flannel created
</span></span><span style="display:flex;"><span>clusterrolebinding.rbac.authorization.k8s.io/flannel created
</span></span><span style="display:flex;"><span>serviceaccount/flannel created
</span></span><span style="display:flex;"><span>configmap/kube-flannel-cfg created
</span></span><span style="display:flex;"><span>daemonset.apps/kube-flannel-ds created
</span></span><span style="display:flex;"><span>&gt; kubectl get pods -A
</span></span><span style="display:flex;"><span>NAMESPACE      NAME                         READY   STATUS    RESTARTS   AGE
</span></span><span style="display:flex;"><span>kube-flannel   kube-flannel-ds-2rcs4        1/1     Running   <span style="color:#ae81ff">0</span>          19s
</span></span><span style="display:flex;"><span>kube-flannel   kube-flannel-ds-9szxg        1/1     Running   <span style="color:#ae81ff">0</span>          19s
</span></span><span style="display:flex;"><span>kube-flannel   kube-flannel-ds-cxw5k        1/1     Running   <span style="color:#ae81ff">0</span>          19s
</span></span><span style="display:flex;"><span>kube-system    coredns-74586cf9b6-2p28x     1/1     Running   <span style="color:#ae81ff">0</span>          3m22s
</span></span><span style="display:flex;"><span>kube-system    coredns-74586cf9b6-lkrn6     1/1     Running   <span style="color:#ae81ff">0</span>          3m22s
</span></span><span style="display:flex;"><span>kube-system    etcd-nm                      1/1     Running   <span style="color:#ae81ff">0</span>          3m34s
</span></span><span style="display:flex;"><span>kube-system    kube-apiserver-nm            1/1     Running   <span style="color:#ae81ff">0</span>          3m34s
</span></span><span style="display:flex;"><span>kube-system    kube-controller-manager-nm   1/1     Running   <span style="color:#ae81ff">0</span>          3m35s
</span></span><span style="display:flex;"><span>kube-system    kube-proxy-7lsdq             1/1     Running   <span style="color:#ae81ff">0</span>          77s
</span></span><span style="display:flex;"><span>kube-system    kube-proxy-fb96h             1/1     Running   <span style="color:#ae81ff">0</span>          74s
</span></span><span style="display:flex;"><span>kube-system    kube-proxy-qcgfk             1/1     Running   <span style="color:#ae81ff">0</span>          3m22s
</span></span><span style="display:flex;"><span>kube-system    kube-scheduler-nm            1/1     Running   <span style="color:#ae81ff">0</span>          3m34s
</span></span><span style="display:flex;"><span>&gt; kubectl get node
</span></span><span style="display:flex;"><span>NAME   STATUS   ROLES           AGE     VERSION
</span></span><span style="display:flex;"><span>na     Ready    &lt;none&gt;          76s     v1.24.3
</span></span><span style="display:flex;"><span>nb     Ready    &lt;none&gt;          79s     v1.24.3
</span></span><span style="display:flex;"><span>nm     Ready    control-plane   3m40s   v1.24.3
</span></span></code></pre></div><p>ÂÆâË£ÖflannelÂâçÔºåcore-dns‰∏∫pending„ÄÅËäÇÁÇπ‰∏∫NotReady„ÄÇÂÆâË£ÖÂêéÊ≠£Â∏∏ÔºåËøôÊòØÁ¨¶ÂêàÈ¢ÑÊúüÁöÑ„ÄÇ</p>
<p>Âπ∂‰∏îcri-dockerd‰∏≠‰πüÊâìÂç∞‰∫ÜcniÁöÑ‰ø°ÊÅØÔºö</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>3090<span style="color:#f92672">]</span> Using CNI configuration file /etc/cni/net.d/10-flannel.conflist 
</span></span><span style="display:flex;"><span>INFO<span style="color:#f92672">[</span>3095<span style="color:#f92672">]</span> Using CNI configuration file /etc/cni/net.d/10-flannel.conflist
</span></span></code></pre></div><p>ÂÜçÊ¨°ÈÉ®ÁΩ≤Áî®‰∫éÊµãËØïÁöÑÊúçÂä°Ôºå‰∏ÄÂàáÊ≠£Â∏∏Ôºö</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>&gt; kubectl get pods -o wide -n cinema
</span></span><span style="display:flex;"><span>NAME                            READY   STATUS    RESTARTS   AGE   IP         NODE   NOMINATED NODE   READINESS GATES
</span></span><span style="display:flex;"><span>bookings-78c77d68f9-j5jzf       1/1     Running   <span style="color:#ae81ff">0</span>          17s   10.5.2.2   na     &lt;none&gt;           &lt;none&gt;
</span></span><span style="display:flex;"><span>mongo-deploy-57dc8c8f49-n6psq   1/1     Running   <span style="color:#ae81ff">0</span>          17s   10.5.1.6   nb     &lt;none&gt;           &lt;none&gt;
</span></span><span style="display:flex;"><span>movies-6fbc5986b9-vs6j8         1/1     Running   <span style="color:#ae81ff">0</span>          17s   10.5.2.3   na     &lt;none&gt;           &lt;none&gt;
</span></span><span style="display:flex;"><span>showtimes-56fc847b7-4bq87       1/1     Running   <span style="color:#ae81ff">0</span>          17s   10.5.1.4   nb     &lt;none&gt;           &lt;none&gt;
</span></span><span style="display:flex;"><span>users-6996b995d4-5l5tq          1/1     Running   <span style="color:#ae81ff">0</span>          17s   10.5.2.4   na     &lt;none&gt;           &lt;none&gt;
</span></span><span style="display:flex;"><span>website-867ff4b9dd-5zz49        1/1     Running   <span style="color:#ae81ff">0</span>          17s   10.5.1.5   nb     &lt;none&gt;           &lt;none&gt;
</span></span><span style="display:flex;"><span>&gt; kubectl get svc -o wide -n cinema
</span></span><span style="display:flex;"><span>NAME          TYPE        CLUSTER-IP      EXTERNAL-IP   PORT<span style="color:#f92672">(</span>S<span style="color:#f92672">)</span>          AGE   SELECTOR
</span></span><span style="display:flex;"><span>bookings      ClusterIP   10.110.129.6    &lt;none&gt;        8080/TCP         27s   app<span style="color:#f92672">=</span>bookings
</span></span><span style="display:flex;"><span>mongodb-svc   ClusterIP   10.103.92.132   &lt;none&gt;        27017/TCP        27s   app<span style="color:#f92672">=</span>mongodb
</span></span><span style="display:flex;"><span>movies        ClusterIP   10.103.102.97   &lt;none&gt;        8080/TCP         27s   app<span style="color:#f92672">=</span>movies
</span></span><span style="display:flex;"><span>showtimes     ClusterIP   10.96.139.99    &lt;none&gt;        8080/TCP         27s   app<span style="color:#f92672">=</span>showtimes
</span></span><span style="display:flex;"><span>users         ClusterIP   10.106.152.98   &lt;none&gt;        8080/TCP         27s   app<span style="color:#f92672">=</span>users
</span></span><span style="display:flex;"><span>website       NodePort    10.96.103.3     &lt;none&gt;        8080:30021/TCP   27s   app<span style="color:#f92672">=</span>website
</span></span></code></pre></div><p><img src="https://picgo-lzl.oss-cn-beijing.aliyuncs.com/202207311754304.png"
	
	
	
	loading="lazy"
	
		alt="image-20220731175441143"
	
	
></p>
<p>Âà∞ËøôÈáåÔºå1.24.0ÁâàÊú¨ÁöÑÈõÜÁæ§Â∞±Ê≠£Â∏∏ÈÉ®ÁΩ≤PodÂπ∂Êèê‰æõÊúçÂä°‰∫Ü„ÄÇ</p>
<h2 id="‰∏Ä‰∫õÈóÆÈ¢ò">‰∏Ä‰∫õÈóÆÈ¢ò</h2>
<h3 id="cri-dockerdÊä•Èîô">cri-dockerdÊä•Èîô</h3>
<p>ËôΩÁÑ∂ÁõÆÂâçÂäüËÉΩ‰∏äÁúãÊù•Ê≤°Âï•ÈóÆÈ¢òÔºå‰ΩÜÊòØcri-dockerd‰∏ÄÁõ¥ÊâìÂç∞ÈîôËØØ‰ø°ÊÅØÔºö</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ERRO<span style="color:#f92672">[</span>3404<span style="color:#f92672">]</span> ContainerStats resp: <span style="color:#f92672">{</span>0xc0003c8900 linux<span style="color:#f92672">}</span>    
</span></span><span style="display:flex;"><span>ERRO<span style="color:#f92672">[</span>3404<span style="color:#f92672">]</span> ContainerStats resp: <span style="color:#f92672">{</span>0xc0005dcb00 linux<span style="color:#f92672">}</span>    
</span></span><span style="display:flex;"><span>ERRO<span style="color:#f92672">[</span>3404<span style="color:#f92672">]</span> ContainerStats resp: <span style="color:#f92672">{</span>0xc0003c9c40 linux<span style="color:#f92672">}</span>    
</span></span><span style="display:flex;"><span>ERRO<span style="color:#f92672">[</span>3404<span style="color:#f92672">]</span> ContainerStats resp: <span style="color:#f92672">{</span>0xc0005dd700 linux<span style="color:#f92672">}</span>    
</span></span><span style="display:flex;"><span>ERRO<span style="color:#f92672">[</span>3404<span style="color:#f92672">]</span> ContainerStats resp: <span style="color:#f92672">{</span>0xc0007be540 linux<span style="color:#f92672">}</span>
</span></span></code></pre></div><p>ÊàëÂ∞ùËØïÂú®ÂΩìÂâçÁâàÊú¨ÁöÑÊ∫êÁ†Å‰∏≠ÈúÄË¶ÅËøôÂè•Êó•ÂøóÁöÑËæìÂá∫‰ΩçÁΩÆÔºåÁªìÊûúÊ≤°ÊúâÂèëÁé∞„ÄÇÁÑ∂ÂêéÂú®Á§æÂå∫‰∏≠Êèê‰∫Ü<a class="link" href="https://github.com/Mirantis/cri-dockerd/issues/98"  target="_blank" rel="noopener"
    >Ëøô‰∏™issue</a>„ÄÇËøô‰∏™ÈóÆÈ¢òÂíåÁ§æÂå∫‰∏≠<a class="link" href="https://github.com/Mirantis/cri-dockerd/issues/85"  target="_blank" rel="noopener"
    >Lots of obscure error logging #85</a>ÈóÆÈ¢òÂ§ßÊ¶ÇÊòØ‰∏ÄÊ†∑ÁöÑÔºåÂèØËÉΩÊòØ‰∏Ä‰∫õÊµãËØï‰∏≠ÁöÑÈÅóÁïôÔºåË¢´ËØØÂêàÂπ∂Âà∞‰∏ªÂàÜÊîØ‰∏äÂéª‰∫Ü„ÄÇ</p>
<p><img src="https://picgo-lzl.oss-cn-beijing.aliyuncs.com/image-20220801181830962.png"
	
	
	
	loading="lazy"
	
		alt="image-20220801181830962"
	
	
></p>
<p>Â•ΩÂú®ÂÆπÂô®ËøêË°åÊó∂ÁöÑÂäüËÉΩË≤å‰ººÊ≤°ÊúâÂèóÂΩ±Âìç„ÄÇ</p>
<h3 id="cri-dockerdÂ∏∏È©ª‰∏Ä‰∏™ÁªàÁ´Ø">cri-dockerdÂ∏∏È©ª‰∏Ä‰∏™ÁªàÁ´Ø</h3>
<p>ËøôÁßçÊñπÊ≥ïÂú®ÂÆâË£Öcri-dockerdÊó∂Â∞ÜÂÖ∂ËßÜ‰∏∫‰∏Ä‰∏™ËΩØ‰ª∂ÔºåÂøÖÈ°ªÊâãÂä®ÂêØÂä®ÂÆÉÔºåÊâçÂèØ‰ª•ËÆ©ÂÆÉÁõëÂê¨socketÂÆûÁé∞Âíåk8s‰ª•ÂèädockerÁöÑÈÄö‰ø°„ÄÇÂçöÊñá<a class="link" href="https://www.modb.pro/db/428370"  target="_blank" rel="noopener"
    >Âü∫‰∫édockerÂíåcri-dockerdÈÉ®ÁΩ≤Kubernetes 1.24</a>‰∏≠ÂàôÊòØ‰ΩøÁî®‰∫ÜÂè¶‰∏ÄÁßçÊñπÊ≥ïÔºåÂπ∂‰∏î‰∏∫ÊàëÊú¨Ê¨°ÁöÑÊµãËØïÊèê‰æõ‰∫ÜÂæàÂ§ßÁöÑÂ∏ÆÂä©„ÄÇ</p>
<blockquote>
<p>ÂΩìÁÑ∂‰πüÂèØ‰ª•ÊåâÁÖßcri-dockerdÁöÑÊñáÊ°£ÔºåÊâãÂä®ÁºñËØë„ÄÅÈÉ®ÁΩ≤„ÄÇ</p>
</blockquote>
<p>Âú®ÂçöÊñá<a class="link" href="https://www.modb.pro/db/428370"  target="_blank" rel="noopener"
    >Âü∫‰∫édockerÂíåcri-dockerdÈÉ®ÁΩ≤Kubernetes 1.24</a>‰∏≠Ôºå‰ΩúËÄÖÁöÑÊÄùË∑Ø‰∏é<a class="link" href="https://github.com/Mirantis/cri-dockerd"  target="_blank" rel="noopener"
    >ÂÆòÊñπÁöÑÂÆâË£ÖÊÄùË∑Ø</a>ÊÄùË∑ØÊòØ‰∏ÄÊ†∑ÁöÑÔºåÂç≥ÔºåÂàõÂª∫‰∏Ä‰∏™ÂèØ‰ª•Ë¢´systemctlÁÆ°ÁêÜÁöÑserviceÂíåsocketÂØπ„ÄÇËÆ©cri-dockerdÂú®ÂêéÂè∞ÂêØÂä®Ôºå‰∏çÁî®ÊòæÂºèÂêØÂä®Âπ∂Âç†Áî®‰∏Ä‰∏™ÁªàÁ´Ø„ÄÇ</p>
<p>ÂÖ∂‰∏≠ÔºåÂÖ≥ÈîÆÈÉ®ÂàÜÂ¶Ç‰∏ã„ÄÇ</p>
<p>È¶ñÂÖàÔºåÂá∫‰∫éÁ≥ªÁªüÈÄöÁî®ÊÄßÔºå‰ΩøÁî®<a class="link" href="https://github.com/Mirantis/cri-dockerd/releases"  target="_blank" rel="noopener"
    >cri-dockerdÁöÑrelease</a>‰∏≠ÁöÑ<code>.amd64.tgz</code>ÁâàÊú¨„ÄÇ</p>
<p><img src="https://picgo-lzl.oss-cn-beijing.aliyuncs.com/image-20220730234545013.png"
	
	
	
	loading="lazy"
	
		alt="image-20220730234545013"
	
	
></p>
<p>Â∞ÜÊñá‰ª∂Ëß£ÂéãÔºåÂπ∂Â∞ÜÈáåÈù¢ÁöÑÂèØÊâßË°åÊñá‰ª∂ÁßªÂä®Âà∞<code>/usr/bin/</code>‰∏ãÈù¢„ÄÇ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>&gt; tar -xf cri-dockerd-0.2.3.amd64.tgz 
</span></span><span style="display:flex;"><span>&gt; cp cri-dockerd/cri-dockerd /usr/bin/
</span></span><span style="display:flex;"><span>&gt; chmod +x /usr/bin/cri-dockerd 
</span></span></code></pre></div><p>ÁÑ∂ÂêéÂæàÈáçË¶ÅÁöÑ‰∏ÄÊ≠•ÔºåÈÖçÁΩÆcri-dockerdÁöÑÂêØÂä®Êñá‰ª∂„ÄÇÂú®<code>/usr/lib/systemd/system/cri-docker.service</code>‰∏≠ÂÜôÂÖ•‰ª•‰∏ãÂÜÖÂÆπÔºö</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">[</span>Unit<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>Description<span style="color:#f92672">=</span>CRI Interface <span style="color:#66d9ef">for</span> Docker Application Container Engine
</span></span><span style="display:flex;"><span>Documentation<span style="color:#f92672">=</span>https://docs.mirantis.com
</span></span><span style="display:flex;"><span>After<span style="color:#f92672">=</span>network-online.target firewalld.service docker.service
</span></span><span style="display:flex;"><span>Wants<span style="color:#f92672">=</span>network-online.target
</span></span><span style="display:flex;"><span>Requires<span style="color:#f92672">=</span>cri-docker.socket
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Service<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>Type<span style="color:#f92672">=</span>notify
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ExecStart<span style="color:#f92672">=</span>/usr/bin/cri-dockerd --network-plugin<span style="color:#f92672">=</span>cni --pod-infra-container-image<span style="color:#f92672">=</span>registry.aliyuncs.com/google_containers/pause:3.7
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ExecReload<span style="color:#f92672">=</span>/bin/kill -s HUP $MAINPID
</span></span><span style="display:flex;"><span>TimeoutSec<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>RestartSec<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>Restart<span style="color:#f92672">=</span>always
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>StartLimitBurst<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>StartLimitInterval<span style="color:#f92672">=</span>60s
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>LimitNOFILE<span style="color:#f92672">=</span>infinity
</span></span><span style="display:flex;"><span>LimitNPROC<span style="color:#f92672">=</span>infinity
</span></span><span style="display:flex;"><span>LimitCORE<span style="color:#f92672">=</span>infinity
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>TasksMax<span style="color:#f92672">=</span>infinity
</span></span><span style="display:flex;"><span>Delegate<span style="color:#f92672">=</span>yes
</span></span><span style="display:flex;"><span>KillMode<span style="color:#f92672">=</span>process
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Install<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>WantedBy<span style="color:#f92672">=</span>multi-user.target
</span></span></code></pre></div><p>Âú®<code>/usr/lib/systemd/system/cri-docker.socket</code>ÂÜôÂÖ•‰∏ãÈù¢ÂÜÖÂÆπÔºö</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">[</span>Unit<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>Description<span style="color:#f92672">=</span>CRI Docker Socket <span style="color:#66d9ef">for</span> the API
</span></span><span style="display:flex;"><span>PartOf<span style="color:#f92672">=</span>cri-docker.service
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Socket<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>ListenStream<span style="color:#f92672">=</span>%t/cri-dockerd.sock
</span></span><span style="display:flex;"><span>SocketMode<span style="color:#f92672">=</span><span style="color:#ae81ff">0660</span>
</span></span><span style="display:flex;"><span>SocketUser<span style="color:#f92672">=</span>root
</span></span><span style="display:flex;"><span>SocketGroup<span style="color:#f92672">=</span>docker
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Install<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>WantedBy<span style="color:#f92672">=</span>sockets.target
</span></span></code></pre></div><p>ÂÖ≥‰∫éËøô‰∏§‰∏™ÈÖçÁΩÆÊñá‰ª∂ÔºåÂèØ‰ª•ÂèÇËÄÉ<a class="link" href="https://www.cnblogs.com/ggzhangxiaochao/p/15039617.html"  target="_blank" rel="noopener"
    >LinuxÈÖçÁΩÆserviceÊúçÂä°</a>Ôºå<a class="link" href="http://www.jinbuguo.com/systemd/systemd.socket.html"  target="_blank" rel="noopener"
    >systemd.socket ‰∏≠ÊñáÊâãÂÜå</a>ÔºåËøôÁØáÊñáÁ´†„ÄÇ</p>
<p>ÁÑ∂ÂêéÊàë‰ª¨ÂêØÂä®Ëøô‰∏™ÊúçÂä°ÔºåËøôÊ†∑cri-dockerdÂÆûÈôÖ‰∏äÂ∞±ÊúâÊàë‰ª¨ÂàöÊâçÂàõÂª∫ÁöÑÂêçÂè´cri-dockerÁöÑserviceÊâÄÁÆ°ÁêÜÔºö</p>
<pre tabindex="0"><code class="language-she" data-lang="she">systemctl daemon-reload
systemctl start cri-docker
systemctl enable cri-docker
systemctl status cri-docker
</code></pre><p>ËøôÊ†∑‰∏ÄÊù•ÔºåÂú®ÊØèÊ¨°ÂêØÂä®ÈõÜÁæ§ÂâçÔºåÂ∞±‰∏çË¶ÅÊâãÂä®ÁöÑÈÖçÁΩÆËøêË°åcri-dockerdÔºåsystemdÂ∞±Â∏ÆÊàë‰ª¨ÂÆåÊàêËøô‰∫õÊìç‰Ωú‰∫Ü„ÄÇ</p>
<h2 id="ÂèÇËÄÉËµÑÊñô">ÂèÇËÄÉËµÑÊñô</h2>
<ul>
<li><a class="link" href="https://www.modb.pro/db/428370"  target="_blank" rel="noopener"
    >Âü∫‰∫édockerÂíåcri-dockerdÈÉ®ÁΩ≤Kubernetes 1.24</a></li>
<li><a class="link" href="https://www.qikqiak.com/post/containerd-usage/"  target="_blank" rel="noopener"
    >‰∏ÄÊñáÊêûÊáÇÂÆπÂô®ËøêË°åÊó∂ Containerd</a></li>
<li><a class="link" href="https://opencontainers.org/"  target="_blank" rel="noopener"
    >Open Container Initiative</a></li>
<li><a class="link" href="https://kubernetes.io/zh-cn/docs/tasks/administer-cluster/migrating-from-dockershim/migrate-dockershim-dockerd/"  target="_blank" rel="noopener"
    >Â∞Ü Docker Engine ËäÇÁÇπ‰ªé dockershim ËøÅÁßªÂà∞ cri-dockerd</a></li>
<li><a class="link" href="https://kubernetes.io/zh-cn/blog/2022/02/17/dockershim-faq/"  target="_blank" rel="noopener"
    >Êõ¥Êñ∞ÔºöÁßªÈô§ Dockershim ÁöÑÂ∏∏ËßÅÈóÆÈ¢ò</a></li>
<li><a class="link" href="https://kubernetes.io/zh-cn/docs/tasks/administer-cluster/migrating-from-dockershim/check-if-dockershim-removal-affects-you/"  target="_blank" rel="noopener"
    >Ê£ÄÊü•ÁßªÈô§ Dockershim ÊòØÂê¶ÂØπ‰Ω†ÊúâÂΩ±Âìç</a></li>
<li><a class="link" href="https://kubernetes.io/zh-cn/docs/tasks/administer-cluster/migrating-from-dockershim/troubleshooting-cni-plugin-related-errors/"  target="_blank" rel="noopener"
    >ÊéíÊü• CNI Êèí‰ª∂Áõ∏ÂÖ≥ÁöÑÈîôËØØ</a></li>
<li><a class="link" href="https://kubernetes.io/zh-cn/docs/setup/production-environment/container-runtimes/#cri-versions"  target="_blank" rel="noopener"
    >ÂÆπÂô®ËøêË°åÊó∂</a></li>
<li><a class="link" href="https://kubernetes.io/zh-cn/docs/concepts/extend-kubernetes/compute-storage-net/network-plugins/"  target="_blank" rel="noopener"
    >ÁΩëÁªúÊèí‰ª∂</a></li>
<li><a class="link" href="https://github.com/kubernetes-sigs"  target="_blank" rel="noopener"
    >kubernetes-sigs</a>/<strong><a class="link" href="https://github.com/kubernetes-sigs/cri-tools"  target="_blank" rel="noopener"
    >cri-tools</a></strong></li>
<li><a class="link" href="https://github.com/Mirantis"  target="_blank" rel="noopener"
    >Mirantis</a>/<strong><a class="link" href="https://github.com/Mirantis/cri-dockerd"  target="_blank" rel="noopener"
    >cri-dockerd</a></strong></li>
<li><a class="link" href="https://blog.51cto.com/liuzhengwei521/2382257"  target="_blank" rel="noopener"
    >k8sÂç∏ËΩΩflannelÁΩëÁªú</a></li>
<li><a class="link" href="https://www.cnblogs.com/lianngkyle/p/15171630.html"  target="_blank" rel="noopener"
    >kubernetes/k8s CNIÂàÜÊûê-ÂÆπÂô®ÁΩëÁªúÊé•Âè£ÂàÜÊûê</a></li>
<li><a class="link" href="https://www.cnblogs.com/ggzhangxiaochao/p/15039617.html"  target="_blank" rel="noopener"
    >LinuxÈÖçÁΩÆserviceÊúçÂä°</a></li>
</ul>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/%E4%BA%91%E5%8E%9F%E7%94%9F/">‰∫ëÂéüÁîü</a>
        
            <a href="/tags/kubernetes/">Kubernetes</a>
        
            <a href="/tags/docker/">docker</a>
        
            <a href="/tags/%E7%AC%94%E8%AE%B0/">Á¨îËÆ∞</a>
        
            <a href="/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6/">‰∏≠Èó¥‰ª∂</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css"integrity="sha256-J&#43;iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s="crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js"integrity="sha256-InsNdER1b2xUewP&#43;pKCUJpkhiqwHgqiPXDlIk7GzBu4="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js"integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI="crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ]
        });})
</script>
    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Áõ∏ÂÖ≥ÊñáÁ´†</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/p/%E8%AE%B0%E4%B8%80%E6%AC%A1kubernetes%E4%BD%BF%E7%94%A8ciliumcoredns%E5%81%A5%E5%BA%B7%E6%A3%80%E6%9F%A5%E5%A4%B1%E8%B4%A5%E7%9A%84%E6%8E%92%E9%94%99/">
        
        

        <div class="article-details">
            <h2 class="article-title">ËÆ∞‰∏ÄÊ¨°Kubernetes‰ΩøÁî®CiliumÔºåcorednsÂÅ•Â∫∑Ê£ÄÊü•Â§±Ë¥•ÁöÑÊéíÈîô</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/sinan-ml-based-and-qos-aware-resource-management-for-cloud-microservices/">
        
        

        <div class="article-details">
            <h2 class="article-title">Sinan: ML-Based and QoS-Aware Resource Management for Cloud Microservices</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/ieee-cloud-21-%E4%BA%91%E4%B8%8A%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E7%9B%B8%E5%85%B3%E5%90%88%E8%BE%91/">
        
        

        <div class="article-details">
            <h2 class="article-title">IEEE CLOUD 21 ‰∫ë‰∏äËµÑÊ∫êÁÆ°ÁêÜÁõ∏ÂÖ≥ÂêàËæë</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/showar-right-sizing-and-efficient-scheduling-of-microservices/">
        
        

        <div class="article-details">
            <h2 class="article-title">SHOWAR: Right-Sizing And Efficient Scheduling of Microservices</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/%E7%AC%94%E8%AE%B0-showar-right-sizing-and-efficient-scheduling-of-microservices/">
        
        

        <div class="article-details">
            <h2 class="article-title">Á¨îËÆ∞ &gt; SHOWAR: Right-Sizing And Efficient Scheduling of Microservices</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2018 - 
        
        2023 fmt.Println(&#34;Li Duo&#34;)
    </section>
    
    <section class="powerby">
        
            Ëá™ËÆ§‰∏∫ÊòØÂπªË±°Ê≥¢ÊôÆÊòüÁöÑÊù•ÂÆ¢ <br/>
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        ‰∏ªÈ¢ò <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.16.0">Stack</a></b> Áî± <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a> ËÆæËÆ°
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
